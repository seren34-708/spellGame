<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VocaDash - è‹±å˜èªã‚¹ãƒšãƒªãƒ³ã‚°ã‚²ãƒ¼ãƒ </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', 'Hiragino Kaku Gothic ProN', 'Meiryo', sans-serif;
            background: 
                linear-gradient(to bottom, 
                    #87CEEB 0%,      /* ç©ºã®é’ */
                    #B0E0E6 30%,     /* æ˜ã‚‹ã„é’ */
                    #90EE90 60%,     /* è‰åŸã®ç·‘ */
                    #7CB342 100%     /* æ¿ƒã„ç·‘ */
                );
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* é›²ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
        body::before {
            content: 'â˜ï¸  â˜ï¸    â˜ï¸     â˜ï¸  â˜ï¸';
            position: fixed;
            top: 10%;
            left: 0;
            width: 200%;
            font-size: 60px;
            opacity: 0.7;
            pointer-events: none;
            animation: cloudFloat 40s linear infinite;
            white-space: nowrap;
        }

        @keyframes cloudFloat {
            0% { 
                transform: translateX(-50%);
            }
            100% { 
                transform: translateX(0%);
            }
        }

        /* è‰ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼1ï¼ˆä¸‹éƒ¨ï¼‰ */
        body::after {
            content: '';
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 150px;
            background-image: 
                linear-gradient(to bottom, transparent 0%, rgba(76, 175, 80, 0.3) 100%);
            background-repeat: repeat-x;
            pointer-events: none;
        }

        /* è‰ã‚’è¿½åŠ ã™ã‚‹ãŸã‚ã®è¿½åŠ ã‚¹ã‚¿ã‚¤ãƒ« */
        .grass-layer-1,
        .grass-layer-2,
        .grass-layer-3 {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            pointer-events: none;
            font-size: 40px;
            white-space: nowrap;
            overflow: hidden;
        }

        .grass-layer-1 {
            z-index: 1;
            opacity: 0.8;
            animation: grassSway1 3s ease-in-out infinite;
        }

        .grass-layer-2 {
            z-index: 2;
            opacity: 0.9;
            animation: grassSway2 2.5s ease-in-out infinite 0.5s;
        }

        .grass-layer-3 {
            z-index: 3;
            opacity: 1;
            animation: grassSway3 3.5s ease-in-out infinite 1s;
        }

        @keyframes grassSway1 {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-3px) rotate(1deg); }
        }

        @keyframes grassSway2 {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-5px) rotate(-1deg); }
        }

        @keyframes grassSway3 {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-4px) rotate(0.5deg); }
        }

        .game-container {
            background: 
                linear-gradient(135deg, rgba(240, 230, 210, 0.95) 0%, rgba(230, 220, 200, 0.95) 100%);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 50px;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.6),
                inset 0 0 0 3px rgba(139, 69, 19, 0.3),
                0 0 0 6px rgba(139, 69, 19, 0.2);
            max-width: 700px;
            width: 100%;
            position: relative;
            animation: containerAppear 0.6s ease-out;
            border: 3px solid #8b4513;
        }

        @keyframes containerAppear {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* è£…é£¾çš„ãªæ­¦å™¨ï¼ˆä¸‹å´ã«é…ç½®ï¼‰ */
        .game-container::before,
        .game-container::after {
            position: absolute;
            font-size: 35px;
            filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.5));
            z-index: 0;
            bottom: 15px;
        }

        .game-container::before {
            content: 'âš”ï¸';
            left: 20px;
        }

        .game-container::after {
            content: 'ğŸ›¡ï¸';
            right: 20px;
        }

        .title {
            text-align: center;
            background: linear-gradient(135deg, #8b4513 0%, #a0522d 50%, #cd853f 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 42px;
            font-weight: bold;
            margin-bottom: 40px;
            text-shadow: 0 0 30px rgba(102, 126, 234, 0.3);
            animation: titleGlow 3s ease-in-out infinite alternate;
            letter-spacing: 2px;
        }

        @keyframes titleGlow {
            from { filter: drop-shadow(0 0 10px rgba(102, 126, 234, 0.4)); }
            to { filter: drop-shadow(0 0 25px rgba(118, 75, 162, 0.6)); }
        }

        /* ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢ */
        .start-screen {
            text-align: center;
        }

        .start-screen h2 {
            font-size: 24px;
            color: #333;
            margin-bottom: 15px;
        }

        .game-info {
            font-size: 20px;
            color: white;
            font-weight: bold;
            margin-bottom: 25px;
            padding: 18px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            box-shadow: 
                0 8px 25px rgba(102, 126, 234, 0.4),
                0 0 0 2px rgba(255, 255, 255, 0.3) inset;
            animation: pulseGlow 2s ease-in-out infinite;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        @keyframes pulseGlow {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 
                    0 8px 25px rgba(102, 126, 234, 0.4),
                    0 0 0 2px rgba(255, 255, 255, 0.3) inset;
            }
            50% { 
                transform: scale(1.02);
                box-shadow: 
                    0 12px 35px rgba(102, 126, 234, 0.6),
                    0 0 0 3px rgba(255, 255, 255, 0.5) inset,
                    0 0 30px rgba(118, 75, 162, 0.4);
            }
        }

        .time-info {
            display: block;
            margin-top: 10px;
            color: #333;
            font-size: 16px;
            font-weight: 600;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            display: inline-block;
        }

        .difficulty-btn:hover .time-info {
            background: rgba(255, 255, 255, 0.95);
            color: #667eea;
        }

        .difficulty-btn small {
            display: block;
            font-size: 18px;
            margin-top: 10px;
            opacity: 0.9;
            color: #555;
            font-weight: 600;
        }

        .difficulty-btn:hover small {
            color: rgba(255, 255, 255, 0.95);
        }

        .difficulty-select {
            margin: 30px 0;
        }

        .difficulty-btn {
            display: block;
            width: 100%;
            padding: 28px;
            margin: 20px 0;
            font-size: 26px;
            font-weight: bold;
            border: none;
            border-radius: 18px;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.1),
                0 0 0 1px rgba(102, 126, 234, 0.1) inset;
            position: relative;
            overflow: hidden;
            line-height: 1.3;
        }

        .difficulty-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(102, 126, 234, 0.2), transparent);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .difficulty-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .difficulty-btn:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 
                0 15px 40px rgba(102, 126, 234, 0.4),
                0 0 0 2px rgba(102, 126, 234, 0.3) inset;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .difficulty-btn:active {
            transform: translateY(-2px) scale(0.98);
        }

        /* é›£æ˜“åº¦åˆ¥ã‚«ãƒ©ãƒ¼ */
        .difficulty-easy {
            border-left: 6px solid #10b981;
        }

        .difficulty-easy::before {
            background: radial-gradient(circle, rgba(16, 185, 129, 0.15), transparent);
        }

        .difficulty-easy:hover {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            box-shadow: 
                0 15px 40px rgba(16, 185, 129, 0.4),
                0 0 0 2px rgba(255, 255, 255, 0.3) inset;
        }

        .difficulty-normal {
            border-left: 6px solid #f59e0b;
        }

        .difficulty-normal::before {
            background: radial-gradient(circle, rgba(245, 158, 11, 0.15), transparent);
        }

        .difficulty-normal:hover {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            box-shadow: 
                0 15px 40px rgba(245, 158, 11, 0.4),
                0 0 0 2px rgba(255, 255, 255, 0.3) inset;
        }

        .difficulty-hard {
            border-left: 6px solid #ef4444;
        }

        .difficulty-hard::before {
            background: radial-gradient(circle, rgba(239, 68, 68, 0.15), transparent);
        }

        .difficulty-hard:hover {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            box-shadow: 
                0 15px 40px rgba(239, 68, 68, 0.4),
                0 0 0 2px rgba(255, 255, 255, 0.3) inset;
        }

        /* ã‚²ãƒ¼ãƒ ç”»é¢ã®ãƒŸãƒ¥ãƒ¼ãƒˆãƒœã‚¿ãƒ³ */
        .mute-btn-game {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
        }

        .mute-btn-game:hover {
            transform: scale(1.15);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        /* ã‚²ãƒ¼ãƒ ç”»é¢ã®ãƒ›ãƒ¼ãƒ ãƒœã‚¿ãƒ³ */
        .home-btn-game {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            z-index: 100;
        }

        .home-btn-game:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        /* ãƒãƒˆãƒ«ã‚·ãƒ¼ãƒ³é€²æ— */
        .progress-dots {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 8px;
            margin-bottom: 30px;
            padding: 25px 20px 15px;
            background: linear-gradient(to bottom, #87ceeb 0%, #e0f6ff 50%, #90ee90 100%);
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            min-height: 100px;
        }

        .progress-dots::before {
            content: 'ğŸ°';
            position: absolute;
            left: 20px;
            bottom: 15px;
            font-size: 40px;
            filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.3));
        }

        .progress-dot {
            width: 50px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            transition: all 0.3s ease;
            position: relative;
            filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.2));
        }

        .progress-dot::before {
            content: 'ğŸ‘¹';
            position: absolute;
        }

        /* ãƒ¬ãƒ™ãƒ«1ï¼ˆ1-4å•ç›®ï¼‰: å¼±ã„ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ */
        .progress-dot:nth-child(-n+4)::before {
            content: 'ğŸ¸';
            font-size: 30px;
        }

        /* ãƒ¬ãƒ™ãƒ«2ï¼ˆ5-7å•ç›®ï¼‰: ä¸­ç´šãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ */
        .progress-dot:nth-child(n+5):nth-child(-n+7)::before {
            content: 'ğŸº';
            font-size: 32px;
        }

        /* ãƒ¬ãƒ™ãƒ«3ï¼ˆ8-9å•ç›®ï¼‰: å¼·ã„ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ */
        .progress-dot:nth-child(n+8):nth-child(-n+9)::before {
            content: 'ğŸ‰';
            font-size: 34px;
        }

        /* 10å•ç›®ã¯ãƒ©ã‚¹ãƒœã‚¹ */
        .progress-dot:nth-child(10)::before {
            content: 'ğŸ‘‘';
            font-size: 38px;
            filter: drop-shadow(0 0 8px gold);
        }

        .progress-dot:nth-child(10) {
            width: 60px;
            height: 70px;
        }

        .progress-dot.current {
            animation: battle-jump 0.6s ease-in-out infinite;
            transform: scale(1.2);
        }

        .progress-dot.current::before {
            content: 'ğŸ—¡ï¸';
        }

        /* 10å•ç›®ã®æˆ¦é—˜ä¸­ã¯ãƒ©ã‚¹ãƒœã‚¹æˆ¦ */
        .progress-dot:nth-child(10).current::before {
            content: 'ğŸ‘‘';
            font-size: 38px;
            filter: drop-shadow(0 0 12px red);
            animation: boss-pulse 1s ease-in-out infinite;
        }

        @keyframes boss-pulse {
            0%, 100% {
                filter: drop-shadow(0 0 12px red);
            }
            50% {
                filter: drop-shadow(0 0 20px orange);
            }
        }

        .progress-dot.correct {
            animation: victory-bounce 0.5s ease-out;
        }

        .progress-dot.correct::before {
            content: 'ğŸ’€';
            opacity: 0.4;
            filter: grayscale(100%);
        }

        /* ãƒ¬ãƒ™ãƒ«1ã®å€’ã•ã‚ŒãŸãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ */
        .progress-dot:nth-child(-n+4).correct::before {
            content: 'ğŸ¸';
            opacity: 0.3;
            filter: grayscale(100%) brightness(0.7);
        }

        /* ãƒ¬ãƒ™ãƒ«2ã®å€’ã•ã‚ŒãŸãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ */
        .progress-dot:nth-child(n+5):nth-child(-n+7).correct::before {
            content: 'ğŸº';
            opacity: 0.3;
            filter: grayscale(100%) brightness(0.7);
        }

        /* ãƒ¬ãƒ™ãƒ«3ã®å€’ã•ã‚ŒãŸãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ */
        .progress-dot:nth-child(n+8):nth-child(-n+9).correct::before {
            content: 'ğŸ‰';
            opacity: 0.3;
            filter: grayscale(100%) brightness(0.7);
        }

        /* 10å•ç›®ã®å‹åˆ©ã¯ç‹å† ãŒå€’ã‚Œã‚‹ */
        .progress-dot:nth-child(10).correct::before {
            content: 'ğŸ‘‘';
            opacity: 0.3;
            filter: grayscale(100%) brightness(0.5);
            transform: rotate(90deg);
        }

        .progress-dot.correct::after {
            content: 'ğŸ›¡ï¸';
            position: absolute;
            top: -15px;
            font-size: 24px;
            animation: shield-appear 0.5s ease-out;
        }

        /* 10å•ç›®ã®å‹åˆ©ã¯ãƒˆãƒ­ãƒ•ã‚£ãƒ¼ */
        .progress-dot:nth-child(10).correct::after {
            content: 'ğŸ†';
            font-size: 28px;
            animation: trophy-appear 0.8s ease-out;
        }

        @keyframes trophy-appear {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 0;
            }
            50% {
                transform: scale(1.8) rotate(180deg);
                opacity: 1;
            }
            100% {
                transform: scale(1) rotate(360deg);
                opacity: 1;
            }
        }

        .progress-dot.incorrect {
            animation: defeat-shake 0.4s ease-out;
        }

        .progress-dot.incorrect::before {
            content: 'ğŸ‘¹';
            transform: scale(1.2);
            filter: drop-shadow(0 0 10px rgba(255, 0, 0, 0.8));
        }

        /* ãƒ¬ãƒ™ãƒ«1ã®å¼·åŒ–ã•ã‚ŒãŸãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ */
        .progress-dot:nth-child(-n+4).incorrect::before {
            content: 'ğŸ¸';
            transform: scale(1.3);
            filter: drop-shadow(0 0 10px rgba(255, 0, 0, 0.8));
        }

        /* ãƒ¬ãƒ™ãƒ«2ã®å¼·åŒ–ã•ã‚ŒãŸãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ */
        .progress-dot:nth-child(n+5):nth-child(-n+7).incorrect::before {
            content: 'ğŸº';
            transform: scale(1.3);
            filter: drop-shadow(0 0 12px rgba(255, 0, 0, 0.9));
        }

        /* ãƒ¬ãƒ™ãƒ«3ã®å¼·åŒ–ã•ã‚ŒãŸãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ */
        .progress-dot:nth-child(n+8):nth-child(-n+9).incorrect::before {
            content: 'ğŸ‰';
            transform: scale(1.3);
            filter: drop-shadow(0 0 15px rgba(255, 0, 0, 1));
        }

        /* 10å•ç›®ã®æ•—åŒ—ã¯ãƒ©ã‚¹ãƒœã‚¹ãŒå¼·åŒ– */
        .progress-dot:nth-child(10).incorrect::before {
            content: 'ğŸ‘‘';
            font-size: 42px;
            transform: scale(1.3);
            filter: drop-shadow(0 0 15px rgba(255, 0, 0, 1));
        }

        .progress-dot.incorrect::after {
            content: 'ğŸ’”';
            position: absolute;
            top: -15px;
            font-size: 20px;
            animation: heart-break 0.5s ease-out;
        }

        @keyframes battle-jump {
            0%, 100% {
                transform: scale(1.2) translateY(0);
            }
            50% {
                transform: scale(1.2) translateY(-10px);
            }
        }

        @keyframes victory-bounce {
            0% {
                transform: scale(1) translateY(0);
            }
            50% {
                transform: scale(1.3) translateY(-20px);
            }
            100% {
                transform: scale(1) translateY(0);
            }
        }

        @keyframes shield-appear {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 0;
            }
            50% {
                transform: scale(1.5) rotate(180deg);
                opacity: 1;
            }
            100% {
                transform: scale(1) rotate(360deg);
                opacity: 1;
            }
        }

        @keyframes defeat-shake {
            0%, 100% {
                transform: translateX(0);
            }
            25% {
                transform: translateX(-5px) rotate(-5deg);
            }
            75% {
                transform: translateX(5px) rotate(5deg);
            }
        }

        @keyframes heart-break {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                transform: scale(1.5);
                opacity: 1;
            }
            100% {
                transform: scale(1) translateY(5px);
                opacity: 1;
            }
        }

        /* ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—é€šçŸ¥ */
        .level-up-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            background-size: 200% 200%;
            padding: 50px 80px;
            border-radius: 30px;
            box-shadow: 
                0 30px 90px rgba(102, 126, 234, 0.6),
                0 0 0 2px rgba(255, 255, 255, 0.3) inset,
                0 0 100px rgba(118, 75, 162, 0.8);
            z-index: 1000;
            display: none;
            animation: levelUpAppear 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }

        .level-up-notification::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, 
                transparent 30%, 
                rgba(255, 255, 255, 0.3) 50%, 
                transparent 70%);
            animation: shine 2s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .level-up-notification::after {
            content: '';
            position: absolute;
            inset: 0;
            background: inherit;
            border-radius: 30px;
            filter: blur(20px);
            opacity: 0.5;
            z-index: -1;
            animation: pulse 1.5s ease-in-out infinite;
        }

        .level-up-notification.show {
            display: block;
            animation: levelUpAppear 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275),
                       backgroundShift 3s ease infinite,
                       float 3s ease-in-out infinite;
        }

        @keyframes levelUpAppear {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.3) rotateZ(-10deg);
            }
            60% {
                transform: translate(-50%, -50%) scale(1.1) rotateZ(5deg);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1) rotateZ(0deg);
            }
        }

        @keyframes backgroundShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        @keyframes float {
            0%, 100% { transform: translate(-50%, -50%) translateY(0px); }
            50% { transform: translate(-50%, -50%) translateY(-10px); }
        }

        .level-up-content {
            text-align: center;
            color: white;
            position: relative;
            z-index: 1;
        }

        .level-up-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: iconBounce 0.8s ease-in-out infinite alternate,
                       rotate 4s linear infinite;
            filter: drop-shadow(0 10px 30px rgba(0, 0, 0, 0.5));
            display: inline-block;
        }

        @keyframes iconBounce {
            from { 
                transform: translateY(0) scale(1);
            }
            to { 
                transform: translateY(-20px) scale(1.1);
            }
        }

        @keyframes rotate {
            from { transform: rotateY(0deg); }
            to { transform: rotateY(360deg); }
        }

        .level-up-text {
            font-size: 32px;
            font-weight: bold;
            text-shadow: 
                0 0 20px rgba(255, 255, 255, 0.8),
                0 4px 10px rgba(0, 0, 0, 0.5),
                0 0 40px rgba(255, 255, 255, 0.4);
            line-height: 1.5;
            animation: textGlow 1.5s ease-in-out infinite alternate;
            letter-spacing: 2px;
        }

        @keyframes textGlow {
            from { 
                text-shadow: 
                    0 0 20px rgba(255, 255, 255, 0.8),
                    0 4px 10px rgba(0, 0, 0, 0.5),
                    0 0 40px rgba(255, 255, 255, 0.4);
            }
            to { 
                text-shadow: 
                    0 0 30px rgba(255, 255, 255, 1),
                    0 4px 15px rgba(0, 0, 0, 0.6),
                    0 0 60px rgba(255, 255, 255, 0.6);
            }
        }

        /* ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
        .level-up-notification .particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }

        .level-up-notification .particle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: radial-gradient(circle, rgba(255, 255, 255, 1), transparent);
            border-radius: 50%;
            animation: particleFloat 3s infinite;
            opacity: 0;
        }

        @keyframes particleFloat {
            0% {
                transform: translateY(100%) translateX(0) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100%) translateX(var(--x-offset)) scale(1);
                opacity: 0;
            }
        }

        /* ã‚¿ã‚¤ãƒãƒ¼ */
        .timer-container {
            text-align: center;
            margin-bottom: 20px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .timer {
            font-size: 48px;
            font-weight: bold;
            color: #667eea;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .timer.warning {
            color: #ff6b6b;
            animation: pulse 0.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* å•é¡Œã‚¨ãƒªã‚¢ */
        .question-area {
            text-align: center;
            margin-bottom: 30px;
        }

        .question-number {
            font-size: 28px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 3px;
            text-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        .meaning {
            font-size: 48px;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            padding: 35px;
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            border-radius: 20px;
            box-shadow: 
                0 15px 40px rgba(253, 203, 110, 0.4),
                0 0 0 1px rgba(255, 255, 255, 0.5) inset;
            min-height: 140px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .meaning::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.3) 0%, transparent 70%);
            animation: shimmer 3s ease-in-out infinite;
        }

        @keyframes shimmer {
            0% { transform: translate(-50%, -50%); }
            50% { transform: translate(0%, 0%); }
            100% { transform: translate(-50%, -50%); }
        }

        .meaning.urgent {
            animation: scaleUp 10s linear forwards, shake 0.5s ease-in-out infinite;
            background: linear-gradient(135deg, #ff7675 0%, #fd79a8 100%);
            box-shadow: 
                0 20px 50px rgba(255, 118, 117, 0.5),
                0 0 30px rgba(253, 121, 168, 0.4);
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0) scale(1); }
            25% { transform: translateX(-2px) scale(1.01); }
            75% { transform: translateX(2px) scale(1.01); }
        }

        @keyframes scaleUp {
            0% { 
                font-size: 48px;
                transform: scale(1);
            }
            100% { 
                font-size: 72px;
                transform: scale(1.2);
            }
        }

        .hint {
            font-size: 16px;
            color: #888;
            margin-bottom: 20px;
        }

        /* å…¥åŠ›ã‚¨ãƒªã‚¢ */
        .input-area {
            margin-bottom: 20px;
            position: relative;
        }

        .letter-boxes {
            display: flex;
            justify-content: center;
            gap: 8px;
            flex-wrap: wrap;
            padding: 10px;
            outline: none;
            cursor: text;
            position: relative;
        }

        .hidden-input {
            position: absolute;
            opacity: 0;
            pointer-events: none;
            width: 1px;
            height: 1px;
        }

        .mobile-input {
            width: 100%;
            padding: 15px;
            font-size: 20px;
            text-align: center;
            border: 3px solid #667eea;
            border-radius: 10px;
            outline: none;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
            background: #f8f9fa;
        }

        .mobile-input:focus {
            border-color: #764ba2;
            background: white;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.3);
        }

        .letter-box {
            width: 50px;
            height: 60px;
            border: 3px solid #667eea;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-transform: lowercase;
            box-shadow: 
                0 4px 15px rgba(0, 0, 0, 0.1),
                0 0 0 1px rgba(255, 255, 255, 0.5) inset;
            position: relative;
        }

        .letter-box::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 12px;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .letter-box.active {
            border-color: #764ba2;
            background: linear-gradient(135deg, #f0f0ff 0%, #e8e8ff 100%);
            box-shadow: 
                0 0 30px rgba(102, 126, 234, 0.5),
                0 8px 20px rgba(0, 0, 0, 0.15);
            transform: scale(1.15) translateY(-3px);
        }

        .letter-box.active::before {
            opacity: 0.2;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.2; }
            50% { opacity: 0.4; }
        }

        .letter-box.filled {
            background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);
            border-color: #667eea;
            transform: scale(1.05);
        }

        .letter-box.hint-letter {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-color: #f59e0b;
            color: #92400e;
            font-weight: bold;
            box-shadow: 
                0 4px 20px rgba(245, 158, 11, 0.3),
                0 0 0 1px rgba(255, 255, 255, 0.5) inset;
        }

        .letter-box.correct {
            background: linear-gradient(135deg, #86efac 0%, #4ade80 100%);
            border-color: #22c55e;
            animation: bounce 0.3s;
        }

        .letter-box.incorrect {
            background: linear-gradient(135deg, #fca5a5 0%, #f87171 100%);
            border-color: #ef4444;
            animation: shake 0.3s;
        }

        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        #answer-input {
            width: 100%;
            padding: 20px;
            font-size: 28px;
            text-align: center;
            border: 4px solid #667eea;
            border-radius: 15px;
            outline: none;
            transition: all 0.3s;
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
        }

        #answer-input:focus {
            border-color: #764ba2;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.4);
            transform: scale(1.02);
        }

        /* ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ */
        .button-area {
            display: flex;
            gap: 15px;
        }

        button {
            flex: 1;
            padding: 18px;
            font-size: 20px;
            font-weight: bold;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 
                0 8px 25px rgba(102, 126, 234, 0.4),
                0 0 0 1px rgba(255, 255, 255, 0.2) inset;
            position: relative;
            overflow: hidden;
        }

        .submit-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .submit-btn:hover::after {
            width: 300px;
            height: 300px;
        }

        .submit-btn:hover:not(:disabled) {
            transform: translateY(-4px);
            box-shadow: 
                0 15px 40px rgba(102, 126, 234, 0.6),
                0 0 0 2px rgba(255, 255, 255, 0.3) inset;
        }

        .submit-btn:active:not(:disabled) {
            transform: translateY(-1px);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .skip-btn {
            background: #ddd;
            color: #666;
        }

        .skip-btn:hover:not(:disabled) {
            background: #ccc;
            transform: translateY(-2px);
        }

        .skip-btn:disabled {
            background: #e0e0e0;
            color: #aaa;
            cursor: not-allowed;
            opacity: 0.6;
        }

        #skip-count {
            font-size: 14px;
            font-weight: normal;
        }

        /* çµæœè¡¨ç¤º */
        .result {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            display: none;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result.correct {
            background: linear-gradient(135deg, #00b894 0%, #00cec9 100%);
            color: white;
            display: block;
        }

        .result.incorrect {
            background: linear-gradient(135deg, #d63031 0%, #ff7675 100%);
            color: white;
            display: block;
        }

        .correct-answer {
            font-size: 20px;
            margin-top: 10px;
            display: block;
        }

        /* ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ç”»é¢ */
        .game-over {
            display: none;
            text-align: center;
        }

        .game-over.show {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .game-over h2 {
            font-size: 36px;
            color: #667eea;
            margin-bottom: 20px;
        }

        .final-score {
            font-size: 56px;
            font-weight: bold;
            color: #667eea;
            margin: 30px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .rank-display {
            font-size: 48px;
            margin: 20px 0;
        }

        .stats {
            background: #f5f7fa;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .stats-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #ddd;
        }

        .stats-item:last-child {
            border-bottom: none;
        }

        .word-results {
            margin: 20px 0;
            max-height: 400px;
            overflow-y: auto;
        }

        .correct-words-section,
        .incorrect-words-section {
            margin-bottom: 25px;
        }

        .correct-words-section h3 {
            color: #00b894;
            font-size: 18px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #00b894;
        }

        .incorrect-words-section h3 {
            color: #d63031;
            font-size: 18px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #d63031;
        }

        .word-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .word-item {
            background: #f8f9fa;
            padding: 12px 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .word-item.correct {
            border-left-color: #00b894;
            background: linear-gradient(90deg, #e8f5f1 0%, #f8f9fa 100%);
        }

        .word-item.incorrect {
            border-left-color: #d63031;
            background: linear-gradient(90deg, #ffe8e8 0%, #f8f9fa 100%);
        }

        .word-meaning {
            font-size: 16px;
            color: #333;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .word-english {
            font-size: 18px;
            color: #667eea;
            font-family: 'Courier New', monospace;
            letter-spacing: 1px;
        }

        .word-item.incorrect .word-english {
            color: #d63031;
        }

        .no-words {
            text-align: center;
            color: #999;
            padding: 20px;
            font-style: italic;
        }

        .restart-btn, .home-btn {
            background: linear-gradient(135deg, #00b894 0%, #00cec9 100%);
            color: white;
            width: 100%;
            margin: 10px 0;
            box-shadow: 0 5px 15px rgba(0, 184, 148, 0.3);
        }

        .restart-btn:hover, .home-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 184, 148, 0.5);
        }

        .home-btn {
            background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);
        }

        /* éè¡¨ç¤ºã‚¯ãƒ©ã‚¹ */
        .hidden {
            display: none !important;
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 600px) {
            .game-container {
                padding: 20px;
            }

            /* è£…é£¾ã‚’éè¡¨ç¤ºï¼ˆã‚¹ãƒšãƒ¼ã‚¹ãŒãªã„ãŸã‚ï¼‰ */
            .game-container::before,
            .game-container::after {
                display: none;
            }
            
            .title {
                font-size: 28px;
                margin-bottom: 30px;
            }

            /* ã‚²ãƒ¼ãƒ ç”»é¢ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’éè¡¨ç¤ºã«ã—ã¦é‡ãªã‚Šã‚’é˜²ã */
            #game-area .title {
                display: none;
            }

            /* ãƒœã‚¿ãƒ³ã®ã‚µã‚¤ã‚ºã¨ä½ç½®èª¿æ•´ */
            .home-btn-game {
                top: 10px;
                left: 10px;
                padding: 8px 14px;
                font-size: 13px;
            }

            .mute-btn-game {
                top: 10px;
                right: 10px;
                width: 40px;
                height: 40px;
                font-size: 18px;
            }
            
            .meaning {
                font-size: 32px;
                padding: 20px;
            }

            .meaning.urgent {
                animation: scaleUpMobile 10s linear forwards;
            }

            @keyframes scaleUpMobile {
                0% { 
                    font-size: 32px;
                    transform: scale(1);
                }
                100% { 
                    font-size: 52px;
                    transform: scale(1.15);
                }
            }

            .letter-box {
                width: 35px;
                height: 45px;
                font-size: 22px;
                gap: 5px;
            }
            
            #answer-input {
                font-size: 24px;
            }

            .word-results {
                max-height: 300px;
            }

            .word-meaning {
                font-size: 14px;
            }

            .word-english {
                font-size: 16px;
            }

            .progress-dots {
                gap: 4px;
                padding: 20px 10px 10px;
                min-height: 80px;
            }

            .progress-dots::before {
                font-size: 28px;
                left: 10px;
                bottom: 10px;
            }

            .progress-dot {
                width: 35px;
                height: 45px;
                font-size: 24px;
            }

            .progress-dot:nth-child(10) {
                width: 42px;
                height: 52px;
            }

            .progress-dot:nth-child(10)::before {
                font-size: 28px;
            }

            .progress-dot:nth-child(10).current::before {
                font-size: 28px;
            }

            .progress-dot:nth-child(10).correct::after {
                font-size: 22px;
                top: -12px;
            }

            .progress-dot:nth-child(10).incorrect::before {
                font-size: 32px;
            }

            .progress-dot.correct::after,
            .progress-dot.incorrect::after {
                font-size: 18px;
                top: -12px;
            }
        }
    </style>
</head>
<body>
    <!-- è‰ãƒ¬ã‚¤ãƒ¤ãƒ¼ -->
    <div class="grass-layer-1">ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿</div>
    <div class="grass-layer-2">ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±</div>
    <div class="grass-layer-3">ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾ğŸŒ±ğŸŒ¿ğŸŒ¾</div>

    <div class="game-container">
        <div class="title">ğŸ® VocaDash</div>

        <!-- ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢ -->
        <div id="start-screen" class="start-screen">
            <h2>é›£æ˜“åº¦ã‚’é¸æŠã—ã¦ãã ã•ã„</h2>
            <p class="game-info">ğŸ“ å…¨10å•ã®ãƒãƒ£ãƒ¬ãƒ³ã‚¸ï¼</p>
            <div class="difficulty-select">
                <button class="difficulty-btn difficulty-easy" onclick="startGame('easy')">
                    ğŸ˜Š ã‹ã‚“ãŸã‚“<br>
                    <small>è‹±æ¤œ3ç´šãƒ¬ãƒ™ãƒ«</small><br>
                    <small class="time-info">â±ï¸ å„å•20ç§’</small>
                </button>
                <button class="difficulty-btn difficulty-normal" onclick="startGame('normal')">
                    ğŸ¯ ãµã¤ã†<br>
                    <small>è‹±æ¤œ2ç´šãƒ¬ãƒ™ãƒ«</small><br>
                    <small class="time-info">â±ï¸ å„å•20ç§’</small>
                </button>
                <button class="difficulty-btn difficulty-hard" onclick="startGame('hard')">
                    ğŸ”¥ ã‚€ãšã‹ã—ã„<br>
                    <small>è‹±æ¤œ1ç´šãƒ¬ãƒ™ãƒ«</small><br>
                    <small class="time-info">â±ï¸ å„å•20ç§’</small>
                </button>
            </div>
        </div>

        <!-- ã‚²ãƒ¼ãƒ ç”»é¢ -->
        <div id="game-area" class="hidden">
            <button id="mute-btn-game" class="mute-btn-game" onclick="toggleMute()">ğŸ”Š</button>
            <button id="back-home-game-btn" class="home-btn-game">ğŸ  ãƒ›ãƒ¼ãƒ </button>

            <div class="progress-dots" id="progress-dots"></div>

            <div class="level-up-notification" id="level-up-notification">
                <div class="level-up-content">
                    <div class="level-up-icon">â¬†ï¸</div>
                    <div class="level-up-text"></div>
                </div>
            </div>

            <div class="timer-container">
                <div class="timer" id="timer">30</div>
            </div>

            <div class="question-area">
                <div class="question-number">Q<span id="current-question">1</span></div>
                <div class="meaning" id="meaning">æº–å‚™ä¸­...</div>
                <div class="hint" id="hint"></div>
            </div>

            <div class="result" id="result"></div>

            <div class="input-area">
                <div id="letter-boxes" class="letter-boxes" tabindex="0"></div>
                <input type="text" id="answer-input" class="hidden-input" autocomplete="off" autocapitalize="off" spellcheck="false">
            </div>

            <div class="button-area">
                <button class="submit-btn" id="submit-btn">å›ç­”ã™ã‚‹</button>
                <button class="skip-btn" id="skip-btn">ã‚¹ã‚­ãƒƒãƒ— <span id="skip-count">(æ®‹ã‚Š1å›)</span></button>
            </div>
        </div>

        <!-- ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ç”»é¢ -->
        <div id="game-over" class="game-over">
            <h2>ğŸ° å†’é™ºå®Œäº†ï¼</h2>
            <div class="rank-display" id="rank-display"></div>
            <div class="final-score" id="final-score">0 / 10</div>
            
            <div class="stats">
                <div class="stats-item">
                    <span>é›£æ˜“åº¦</span>
                    <strong id="difficulty-display">-</strong>
                </div>
            </div>

            <div class="word-results">
                <div class="correct-words-section">
                    <h3>âš”ï¸ è¨ä¼æˆåŠŸ</h3>
                    <div id="correct-words-list" class="word-list"></div>
                </div>
                <div class="incorrect-words-section">
                    <h3>ğŸ’€ è¨ä¼å¤±æ•—</h3>
                    <div id="incorrect-words-list" class="word-list"></div>
                </div>
            </div>

            <button class="restart-btn" id="restart-btn">ã‚‚ã†ä¸€åº¦ãƒ—ãƒ¬ã‚¤</button>
            <button class="home-btn" id="home-btn">é›£æ˜“åº¦é¸æŠã«æˆ»ã‚‹</button>
        </div>
    </div>

    <script>
        // å•é¡Œãƒ‡ãƒ¼ã‚¿ï¼ˆè‹±æ¤œãƒ¬ãƒ™ãƒ«åˆ¥ãƒ»æ®µéšçš„é›£æ˜“åº¦ï¼‰
        const questionBank = {
            // ã‹ã‚“ãŸã‚“ï¼šè‹±æ¤œ5ç´š(4å•) â†’ 4ç´š(3å•) â†’ 3ç´š(3å•)
            easy: {
                grade5: [ // è‹±æ¤œ5ç´šãƒ¬ãƒ™ãƒ«ï¼ˆè¶…åŸºç¤ï¼‰
                    { meaning: "å¤§ãã„", answer: "big", hint: "3æ–‡å­—" },
                    { meaning: "å°ã•ã„", answer: "small", hint: "5æ–‡å­—" },
                    { meaning: "è‰¯ã„", answer: "good", hint: "4æ–‡å­—" },
                    { meaning: "æ–°ã—ã„", answer: "new", hint: "3æ–‡å­—" },
                    { meaning: "å¤ã„", answer: "old", hint: "3æ–‡å­—" },
                    { meaning: "é€Ÿã„", answer: "fast", hint: "4æ–‡å­—" },
                    { meaning: "é…ã„", answer: "slow", hint: "4æ–‡å­—" },
                    { meaning: "æš‘ã„", answer: "hot", hint: "3æ–‡å­—" },
                    { meaning: "å¯’ã„", answer: "cold", hint: "4æ–‡å­—" },
                    { meaning: "é•·ã„", answer: "long", hint: "4æ–‡å­—" },
                    { meaning: "çŸ­ã„", answer: "short", hint: "5æ–‡å­—" },
                    { meaning: "é«˜ã„", answer: "high", hint: "4æ–‡å­—" },
                    { meaning: "ä½ã„", answer: "low", hint: "3æ–‡å­—" },
                    { meaning: "å¹¸ã›ãª", answer: "happy", hint: "5æ–‡å­—" },
                    { meaning: "æ‚²ã—ã„", answer: "sad", hint: "3æ–‡å­—" },
                    { meaning: "è‹¥ã„", answer: "young", hint: "5æ–‡å­—" },
                    { meaning: "å‹é”", answer: "friend", hint: "6æ–‡å­—" },
                    { meaning: "å®¶æ—", answer: "family", hint: "6æ–‡å­—" },
                    { meaning: "å­¦æ ¡", answer: "school", hint: "6æ–‡å­—" },
                    { meaning: "æœ¬", answer: "book", hint: "4æ–‡å­—" },
                ],
                grade4: [ // è‹±æ¤œ4ç´šãƒ¬ãƒ™ãƒ«ï¼ˆåŸºç¤ï¼‰
                    { meaning: "ç¾ã—ã„", answer: "beautiful", hint: "9æ–‡å­—" },
                    { meaning: "ä¾¿åˆ©ãª", answer: "convenient", hint: "10æ–‡å­—" },
                    { meaning: "äººæ°—ã®ã‚ã‚‹", answer: "popular", hint: "7æ–‡å­—" },
                    { meaning: "æœ‰åãª", answer: "famous", hint: "6æ–‡å­—" },
                    { meaning: "å¥åº·ãª", answer: "healthy", hint: "7æ–‡å­—" },
                    { meaning: "å±é™ºãª", answer: "dangerous", hint: "9æ–‡å­—" },
                    { meaning: "é™ã‹ãª", answer: "quiet", hint: "5æ–‡å­—" },
                    { meaning: "ã†ã‚‹ã•ã„", answer: "noisy", hint: "5æ–‡å­—" },
                    { meaning: "æ˜ã‚‹ã„", answer: "bright", hint: "6æ–‡å­—" },
                    { meaning: "æš—ã„", answer: "dark", hint: "4æ–‡å­—" },
                    { meaning: "ç°¡å˜ãª", answer: "easy", hint: "4æ–‡å­—" },
                    { meaning: "å¼·ã„", answer: "strong", hint: "6æ–‡å­—" },
                    { meaning: "å¼±ã„", answer: "weak", hint: "4æ–‡å­—" },
                    { meaning: "å®‰å…¨ãª", answer: "safe", hint: "4æ–‡å­—" },
                    { meaning: "è¨ªã‚Œã‚‹", answer: "visit", hint: "5æ–‡å­—" },
                    { meaning: "ç†è§£ã™ã‚‹", answer: "understand", hint: "10æ–‡å­—" },
                    { meaning: "èª¬æ˜ã™ã‚‹", answer: "explain", hint: "7æ–‡å­—" },
                    { meaning: "é¸ã¶", answer: "choose", hint: "6æ–‡å­—" },
                    { meaning: "æ—…è¡Œ", answer: "travel", hint: "6æ–‡å­—" },
                    { meaning: "ä¼‘æš‡", answer: "vacation", hint: "8æ–‡å­—" },
                ],
                grade3: [ // è‹±æ¤œ3ç´šãƒ¬ãƒ™ãƒ«ï¼ˆä¸­å­¦å’æ¥­ï¼‰
                    { meaning: "é‡è¦ãª", answer: "important", hint: "9æ–‡å­—" },
                    { meaning: "èˆˆå‘³æ·±ã„", answer: "interesting", hint: "11æ–‡å­—" },
                    { meaning: "ç‰¹åˆ¥ãª", answer: "special", hint: "7æ–‡å­—" },
                    { meaning: "å®Œç’§ãª", answer: "perfect", hint: "7æ–‡å­—" },
                    { meaning: "è‡ªç„¶ãª", answer: "natural", hint: "7æ–‡å­—" },
                    { meaning: "å›½éš›çš„ãª", answer: "international", hint: "13æ–‡å­—" },
                    { meaning: "ä¼çµ±çš„ãª", answer: "traditional", hint: "11æ–‡å­—" },
                    { meaning: "ç¾ä»£çš„ãª", answer: "modern", hint: "6æ–‡å­—" },
                    { meaning: "ç§‘å­¦", answer: "science", hint: "7æ–‡å­—" },
                    { meaning: "æ­´å²", answer: "history", hint: "7æ–‡å­—" },
                    { meaning: "æ–‡åŒ–", answer: "culture", hint: "7æ–‡å­—" },
                    { meaning: "ç¤¾ä¼š", answer: "society", hint: "7æ–‡å­—" },
                    { meaning: "ç’°å¢ƒ", answer: "environment", hint: "11æ–‡å­—" },
                    { meaning: "çµŒé¨“", answer: "experience", hint: "10æ–‡å­—" },
                    { meaning: "çŸ¥è­˜", answer: "knowledge", hint: "9æ–‡å­—" },
                    { meaning: "æ•™è‚²", answer: "education", hint: "9æ–‡å­—" },
                    { meaning: "æƒ…å ±", answer: "information", hint: "11æ–‡å­—" },
                    { meaning: "æ”¿åºœ", answer: "government", hint: "10æ–‡å­—" },
                    { meaning: "ç™ºè¦‹ã™ã‚‹", answer: "discover", hint: "8æ–‡å­—" },
                    { meaning: "æ”¹å–„ã™ã‚‹", answer: "improve", hint: "7æ–‡å­—" },
                ]
            },
            
            // ãµã¤ã†ï¼šè‹±æ¤œæº–2ç´š(4å•) â†’ 2ç´šå‰åŠ(3å•) â†’ 2ç´šå¾ŒåŠ(3å•)
            normal: {
                preGrade2: [ // è‹±æ¤œæº–2ç´šãƒ¬ãƒ™ãƒ«
                    { meaning: "é›£ã—ã„", answer: "difficult", hint: "9æ–‡å­—" },
                    { meaning: "å¿…è¦ãª", answer: "necessary", hint: "9æ–‡å­—" },
                    { meaning: "å¯èƒ½ãª", answer: "possible", hint: "8æ–‡å­—" },
                    { meaning: "ä¸å¯èƒ½ãª", answer: "impossible", hint: "10æ–‡å­—" },
                    { meaning: "æ˜ã‚‰ã‹ãª", answer: "obvious", hint: "7æ–‡å­—" },
                    { meaning: "å˜ç´”ãª", answer: "simple", hint: "6æ–‡å­—" },
                    { meaning: "ä¸€èˆ¬çš„ãª", answer: "general", hint: "7æ–‡å­—" },
                    { meaning: "ç‰¹å®šã®", answer: "particular", hint: "10æ–‡å­—" },
                    { meaning: "æˆåŠŸã™ã‚‹", answer: "succeed", hint: "7æ–‡å­—" },
                    { meaning: "å¤±æ•—ã™ã‚‹", answer: "fail", hint: "4æ–‡å­—" },
                    { meaning: "ç¶šã‘ã‚‹", answer: "continue", hint: "8æ–‡å­—" },
                    { meaning: "å¢—ã‚„ã™", answer: "increase", hint: "8æ–‡å­—" },
                    { meaning: "æ¸›ã‚‰ã™", answer: "decrease", hint: "8æ–‡å­—" },
                    { meaning: "å¤‰ãˆã‚‹", answer: "change", hint: "6æ–‡å­—" },
                    { meaning: "æ¯”è¼ƒã™ã‚‹", answer: "compare", hint: "7æ–‡å­—" },
                    { meaning: "å«ã‚€", answer: "include", hint: "7æ–‡å­—" },
                    { meaning: "æŒ‘æˆ¦", answer: "challenge", hint: "9æ–‡å­—" },
                    { meaning: "æ©Ÿä¼š", answer: "opportunity", hint: "11æ–‡å­—" },
                    { meaning: "æˆåŠŸ", answer: "success", hint: "7æ–‡å­—" },
                    { meaning: "çµæœ", answer: "result", hint: "6æ–‡å­—" },
                ],
                grade2Early: [ // è‹±æ¤œ2ç´šå‰åŠãƒ¬ãƒ™ãƒ«
                    { meaning: "åŠ¹æœçš„ãª", answer: "effective", hint: "9æ–‡å­—" },
                    { meaning: "é©åˆ‡ãª", answer: "appropriate", hint: "11æ–‡å­—" },
                    { meaning: "è¤‡é›‘ãª", answer: "complex", hint: "7æ–‡å­—" },
                    { meaning: "å…·ä½“çš„ãª", answer: "specific", hint: "8æ–‡å­—" },
                    { meaning: "å…¬å¼ã®", answer: "official", hint: "8æ–‡å­—" },
                    { meaning: "æ­£ç¢ºãª", answer: "accurate", hint: "8æ–‡å­—" },
                    { meaning: "ååˆ†ãª", answer: "sufficient", hint: "10æ–‡å­—" },
                    { meaning: "ç‹¬ç«‹ã—ãŸ", answer: "independent", hint: "11æ–‡å­—" },
                    { meaning: "é”æˆã™ã‚‹", answer: "achieve", hint: "7æ–‡å­—" },
                    { meaning: "ç™ºå±•ã™ã‚‹", answer: "develop", hint: "7æ–‡å­—" },
                    { meaning: "ç¶­æŒã™ã‚‹", answer: "maintain", hint: "8æ–‡å­—" },
                    { meaning: "ç¢ºç«‹ã™ã‚‹", answer: "establish", hint: "9æ–‡å­—" },
                    { meaning: "å½±éŸ¿", answer: "influence", hint: "9æ–‡å­—" },
                    { meaning: "æ…‹åº¦", answer: "attitude", hint: "8æ–‡å­—" },
                    { meaning: "èƒ½åŠ›", answer: "ability", hint: "7æ–‡å­—" },
                    { meaning: "åˆ©ç‚¹", answer: "advantage", hint: "9æ–‡å­—" },
                    { meaning: "è¨¼æ‹ ", answer: "evidence", hint: "8æ–‡å­—" },
                    { meaning: "é”æˆ", answer: "achievement", hint: "11æ–‡å­—" },
                    { meaning: "ç›®çš„", answer: "purpose", hint: "7æ–‡å­—" },
                    { meaning: "æ–¹æ³•", answer: "method", hint: "6æ–‡å­—" },
                ],
                grade2Late: [ // è‹±æ¤œ2ç´šå¾ŒåŠãƒ¬ãƒ™ãƒ«
                    { meaning: "ç©æ¥µçš„ãª", answer: "positive", hint: "8æ–‡å­—" },
                    { meaning: "æ¶ˆæ¥µçš„ãª", answer: "negative", hint: "8æ–‡å­—" },
                    { meaning: "æ°¸ä¹…ã®", answer: "permanent", hint: "9æ–‡å­—" },
                    { meaning: "ä¸€æ™‚çš„ãª", answer: "temporary", hint: "9æ–‡å­—" },
                    { meaning: "ä¸»è¦ãª", answer: "primary", hint: "7æ–‡å­—" },
                    { meaning: "æœ¬è³ªçš„ãª", answer: "essential", hint: "9æ–‡å­—" },
                    { meaning: "é‡å¤§ãª", answer: "critical", hint: "8æ–‡å­—" },
                    { meaning: "é‡è¦ãª", answer: "significant", hint: "11æ–‡å­—" },
                    { meaning: "é–¢é€£ã—ãŸ", answer: "relevant", hint: "8æ–‡å­—" },
                    { meaning: "çµ„ç¹”ã™ã‚‹", answer: "organize", hint: "8æ–‡å­—" },
                    { meaning: "ç®¡ç†ã™ã‚‹", answer: "manage", hint: "6æ–‡å­—" },
                    { meaning: "è©•ä¾¡ã™ã‚‹", answer: "evaluate", hint: "8æ–‡å­—" },
                    { meaning: "åˆ†æã™ã‚‹", answer: "analyze", hint: "7æ–‡å­—" },
                    { meaning: "èª¿æŸ»ã™ã‚‹", answer: "investigate", hint: "11æ–‡å­—" },
                    { meaning: "ç ”ç©¶ã™ã‚‹", answer: "research", hint: "8æ–‡å­—" },
                    { meaning: "æ©Ÿèƒ½", answer: "function", hint: "8æ–‡å­—" },
                    { meaning: "è³‡æº", answer: "resource", hint: "8æ–‡å­—" },
                    { meaning: "å‚¾å‘", answer: "tendency", hint: "8æ–‡å­—" },
                    { meaning: "åŸå‰‡", answer: "principle", hint: "9æ–‡å­—" },
                    { meaning: "æ¦‚å¿µ", answer: "concept", hint: "7æ–‡å­—" },
                ]
            },
            
            // ã‚€ãšã‹ã—ã„ï¼šè‹±æ¤œæº–1ç´š(4å•) â†’ 1ç´šå‰åŠ(3å•) â†’ 1ç´šå¾ŒåŠ(3å•)
            hard: {
                preGrade1: [ // è‹±æ¤œæº–1ç´šãƒ¬ãƒ™ãƒ«
                    { meaning: "é©åº¦ãª", answer: "moderate", hint: "8æ–‡å­—" },
                    { meaning: "éåº¦ã®", answer: "excessive", hint: "9æ–‡å­—" },
                    { meaning: "æŸ”è»Ÿãª", answer: "flexible", hint: "8æ–‡å­—" },
                    { meaning: "å³æ ¼ãª", answer: "strict", hint: "6æ–‡å­—" },
                    { meaning: "å¯›å¤§ãª", answer: "generous", hint: "8æ–‡å­—" },
                    { meaning: "å³ã—ã„", answer: "severe", hint: "6æ–‡å­—" },
                    { meaning: "æ¥µç«¯ãª", answer: "extreme", hint: "7æ–‡å­—" },
                    { meaning: "ä¿¡é ¼ã§ãã‚‹", answer: "reliable", hint: "8æ–‡å­—" },
                    { meaning: "é©åˆ‡ãª", answer: "suitable", hint: "8æ–‡å­—" },
                    { meaning: "åˆ©ç”¨å¯èƒ½ãª", answer: "available", hint: "9æ–‡å­—" },
                    { meaning: "ä¿ƒé€²ã™ã‚‹", answer: "promote", hint: "7æ–‡å­—" },
                    { meaning: "å¦¨ã’ã‚‹", answer: "prevent", hint: "7æ–‡å­—" },
                    { meaning: "è¨±å¯ã™ã‚‹", answer: "permit", hint: "6æ–‡å­—" },
                    { meaning: "ç¦æ­¢ã™ã‚‹", answer: "forbid", hint: "6æ–‡å­—" },
                    { meaning: "è¦æ±‚ã™ã‚‹", answer: "require", hint: "7æ–‡å­—" },
                    { meaning: "æä¾›ã™ã‚‹", answer: "provide", hint: "7æ–‡å­—" },
                    { meaning: "æˆ¦ç•¥", answer: "strategy", hint: "8æ–‡å­—" },
                    { meaning: "æŠ€è¡“", answer: "technique", hint: "9æ–‡å­—" },
                    { meaning: "æ‰‹é †", answer: "procedure", hint: "9æ–‡å­—" },
                    { meaning: "éç¨‹", answer: "process", hint: "7æ–‡å­—" },
                ],
                grade1Early: [ // è‹±æ¤œ1ç´šå‰åŠãƒ¬ãƒ™ãƒ«
                    { meaning: "æ›–æ˜§ãª", answer: "ambiguous", hint: "9æ–‡å­—" },
                    { meaning: "æ´—ç·´ã•ã‚ŒãŸ", answer: "sophisticated", hint: "13æ–‡å­—" },
                    { meaning: "åŒ…æ‹¬çš„ãª", answer: "comprehensive", hint: "13æ–‡å­—" },
                    { meaning: "è­°è«–ã®ä½™åœ°ãŒã‚ã‚‹", answer: "controversial", hint: "13æ–‡å­—" },
                    { meaning: "é¡•è‘—ãª", answer: "prominent", hint: "9æ–‡å­—" },
                    { meaning: "ä¸€æ™‚çš„ãª", answer: "transient", hint: "9æ–‡å­—" },
                    { meaning: "æ°¸ç¶šçš„ãª", answer: "perpetual", hint: "9æ–‡å­—" },
                    { meaning: "å†—é•·ãª", answer: "redundant", hint: "9æ–‡å­—" },
                    { meaning: "ç°¡æ½”ãª", answer: "concise", hint: "7æ–‡å­—" },
                    { meaning: "å¾¹åº•çš„ãª", answer: "thorough", hint: "8æ–‡å­—" },
                    { meaning: "å¼·èª¿ã™ã‚‹", answer: "emphasize", hint: "9æ–‡å­—" },
                    { meaning: "å®Ÿæ–½ã™ã‚‹", answer: "implement", hint: "9æ–‡å­—" },
                    { meaning: "æ­£å½“åŒ–ã™ã‚‹", answer: "justify", hint: "7æ–‡å­—" },
                    { meaning: "æ“ä½œã™ã‚‹", answer: "manipulate", hint: "10æ–‡å­—" },
                    { meaning: "ç·©å’Œã™ã‚‹", answer: "mitigate", hint: "8æ–‡å­—" },
                    { meaning: "çŸ›ç›¾", answer: "contradiction", hint: "13æ–‡å­—" },
                    { meaning: "ç¾è±¡", answer: "phenomenon", hint: "10æ–‡å­—" },
                    { meaning: "ä»®èª¬", answer: "hypothesis", hint: "10æ–‡å­—" },
                    { meaning: "æ¨è«–", answer: "inference", hint: "9æ–‡å­—" },
                    { meaning: "å«æ„", answer: "implication", hint: "11æ–‡å­—" },
                ],
                grade1Late: [ // è‹±æ¤œ1ç´šå¾ŒåŠãƒ¬ãƒ™ãƒ«
                    { meaning: "å‰ä¾‹ã®ãªã„", answer: "unprecedented", hint: "13æ–‡å­—" },
                    { meaning: "éåœ¨ã™ã‚‹", answer: "ubiquitous", hint: "10æ–‡å­—" },
                    { meaning: "å³æ ¼ãª", answer: "rigorous", hint: "8æ–‡å­—" },
                    { meaning: "æ•µå¯¾çš„ãª", answer: "hostile", hint: "7æ–‡å­—" },
                    { meaning: "å‹å¥½çš„ãª", answer: "amicable", hint: "8æ–‡å­—" },
                    { meaning: "è‡ªå¾‹çš„ãª", answer: "autonomous", hint: "10æ–‡å­—" },
                    { meaning: "å¾“å±çš„ãª", answer: "subordinate", hint: "11æ–‡å­—" },
                    { meaning: "ä½“ç³»çš„ãª", answer: "systematic", hint: "10æ–‡å­—" },
                    { meaning: "æ–­ç‰‡çš„ãª", answer: "fragmentary", hint: "11æ–‡å­—" },
                    { meaning: "é¡•åœ¨çš„ãª", answer: "explicit", hint: "8æ–‡å­—" },
                    { meaning: "ä¿ƒé€²ã™ã‚‹", answer: "facilitate", hint: "10æ–‡å­—" },
                    { meaning: "é˜»å®³ã™ã‚‹", answer: "inhibit", hint: "7æ–‡å­—" },
                    { meaning: "çµ±åˆã™ã‚‹", answer: "integrate", hint: "9æ–‡å­—" },
                    { meaning: "åˆ†é›¢ã™ã‚‹", answer: "segregate", hint: "9æ–‡å­—" },
                    { meaning: "å¤šæ§˜åŒ–ã™ã‚‹", answer: "diversify", hint: "9æ–‡å­—" },
                    { meaning: "æ¨™æº–åŒ–ã™ã‚‹", answer: "standardize", hint: "11æ–‡å­—" },
                    { meaning: "å‰æ", answer: "premise", hint: "7æ–‡å­—" },
                    { meaning: "åŸºæº–", answer: "criterion", hint: "9æ–‡å­—" },
                    { meaning: "è¦–ç‚¹", answer: "perspective", hint: "11æ–‡å­—" },
                    { meaning: "ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ", answer: "paradigm", hint: "8æ–‡å­—" },
                ]
            }
        };

        // ã‚²ãƒ¼ãƒ å¤‰æ•°
        let currentDifficulty = 'normal';
        let currentQuestionIndex = 0;
        let correctCount = 0;
        let gameQuestions = [];
        let timer = null;
        let timeLeft = 20;
        let timeLimit = 20;
        let answeredQuestions = [];
        let currentAnswer = '';
        let skipsRemaining = 1;

        // éŸ³å£°é–¢é€£
        let audioContext = null;
        let bgmGainNode = null;
        let bgmOscillators = [];
        let bgmTimeout = null;  // BGMãƒ«ãƒ¼ãƒ—ç”¨ã®ã‚¿ã‚¤ãƒãƒ¼ID
        let isMuted = false;

        // AudioContextã®åˆæœŸåŒ–
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                bgmGainNode = audioContext.createGain();
                bgmGainNode.gain.value = 0.15;
                bgmGainNode.connect(audioContext.destination);
            }
        }

        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”¨BGMï¼ˆRPGã®ç”ºãƒ»é…’å ´é¢¨ï¼‰
        function playMenuBGM() {
            initAudio();
            stopBGM();

            // RPGé¢¨ã®ãƒ¡ãƒ­ãƒ‡ã‚£ï¼ˆãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼ãƒ»å†’é™ºã®äºˆæ„Ÿï¼‰
            const melody = [
                // ãƒ•ãƒ¬ãƒ¼ã‚º1: å‹‡å£®ãªãƒ†ãƒ¼ãƒ
                { freq: 329.63, start: 0, duration: 0.5 },      // E4
                { freq: 392.00, start: 0.5, duration: 0.5 },    // G4
                { freq: 493.88, start: 1.0, duration: 0.6 },    // B4
                { freq: 523.25, start: 1.6, duration: 0.8 },    // C5
                
                // ãƒ•ãƒ¬ãƒ¼ã‚º2: å†’é™ºã®æ—‹å¾‹
                { freq: 587.33, start: 2.5, duration: 0.5 },    // D5
                { freq: 523.25, start: 3.0, duration: 0.5 },    // C5
                { freq: 493.88, start: 3.5, duration: 0.5 },    // B4
                { freq: 392.00, start: 4.0, duration: 1.0 },    // G4
            ];

            // ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ï¼ˆåŠ›å¼·ã„åœŸå°ï¼‰
            const bassline = [
                { freq: 164.81, start: 0, duration: 1.0 },      // E3
                { freq: 196.00, start: 1.0, duration: 1.0 },    // G3
                { freq: 130.81, start: 2.0, duration: 1.5 },    // C3
                { freq: 146.83, start: 3.5, duration: 1.5 },    // D3
            ];

            // å’ŒéŸ³ï¼ˆãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼æ„Ÿï¼‰
            const chords = [
                { freq: 659.25, start: 0, duration: 1.0 },      // E5
                { freq: 783.99, start: 1.0, duration: 1.0 },    // G5
                { freq: 523.25, start: 2.5, duration: 1.5 },    // C5
                { freq: 587.33, start: 4.0, duration: 1.0 },    // D5
            ];

            const now = audioContext.currentTime;
            
            // ãƒ¡ãƒ­ãƒ‡ã‚£å†ç”Ÿï¼ˆsquare waveã§ä¸­ä¸–æ¥½å™¨é¢¨ï¼‰
            melody.forEach(note => {
                const osc = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                osc.type = 'square'; // ä¸­ä¸–æ¥½å™¨é¢¨ã®éŸ³è‰²
                osc.frequency.value = note.freq;
                
                gainNode.gain.setValueAtTime(0, now + note.start);
                gainNode.gain.linearRampToValueAtTime(0.15, now + note.start + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + note.start + note.duration);
                
                osc.connect(gainNode);
                gainNode.connect(bgmGainNode);
                
                osc.start(now + note.start);
                osc.stop(now + note.start + note.duration);
                
                bgmOscillators.push(osc);
            });

            // ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³å†ç”Ÿ
            bassline.forEach(note => {
                const osc = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                osc.type = 'sawtooth'; // é‡åšãªä½éŸ³
                osc.frequency.value = note.freq;
                
                gainNode.gain.setValueAtTime(0, now + note.start);
                gainNode.gain.linearRampToValueAtTime(0.12, now + note.start + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + note.start + note.duration);
                
                osc.connect(gainNode);
                gainNode.connect(bgmGainNode);
                
                osc.start(now + note.start);
                osc.stop(now + note.start + note.duration);
                
                bgmOscillators.push(osc);
            });

            // å’ŒéŸ³ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼æ„Ÿã‚’æ¼”å‡ºï¼‰
            chords.forEach(note => {
                const osc = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                osc.type = 'triangle'; // æŸ”ã‚‰ã‹ã„å’ŒéŸ³
                osc.frequency.value = note.freq;
                
                gainNode.gain.setValueAtTime(0, now + note.start);
                gainNode.gain.linearRampToValueAtTime(0.08, now + note.start + 0.02);
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + note.start + note.duration);
                
                osc.connect(gainNode);
                gainNode.connect(bgmGainNode);
                
                osc.start(now + note.start);
                osc.stop(now + note.start + note.duration);
                
                bgmOscillators.push(osc);
            });

            // ãƒ«ãƒ¼ãƒ—å†ç”Ÿï¼ˆRPGã‚‰ã—ã„ãƒ†ãƒ³ãƒï¼‰
            bgmTimeout = setTimeout(() => {
                if (bgmOscillators.length > 0) {
                    playMenuBGM();
                }
            }, 5000);
        }
        function playBGM() {
            initAudio();
            stopBGM();

            // ç·Šå¼µæ„Ÿã®ã‚ã‚‹ãƒ¡ãƒ­ãƒ‡ã‚£ï¼ˆçŸ­èª¿ãƒ»ã‚¹ãƒªãƒªãƒ³ã‚°ï¼‰
            const melody = [
                // ãƒ•ãƒ¬ãƒ¼ã‚º1: ç·Šè¿«æ„Ÿã®ã‚ã‚‹ä¸Šæ˜‡
                { freq: 329.63, start: 0, duration: 0.15 },     // E4
                { freq: 392.00, start: 0.15, duration: 0.15 },  // G4
                { freq: 440.00, start: 0.3, duration: 0.15 },   // A4
                { freq: 493.88, start: 0.45, duration: 0.2 },   // B4
                
                // ãƒ•ãƒ¬ãƒ¼ã‚º2: åå¾©ã§ç·Šå¼µã‚’é«˜ã‚ã‚‹
                { freq: 523.25, start: 0.7, duration: 0.15 },   // C5
                { freq: 493.88, start: 0.85, duration: 0.15 },  // B4
                { freq: 440.00, start: 1.0, duration: 0.15 },   // A4
                { freq: 493.88, start: 1.15, duration: 0.2 },   // B4
                
                // ãƒ•ãƒ¬ãƒ¼ã‚º3: é«˜éŸ³ã§ç·Šè¿«æ„Ÿ
                { freq: 587.33, start: 1.4, duration: 0.15 },   // D5
                { freq: 523.25, start: 1.55, duration: 0.15 },  // C5
                { freq: 493.88, start: 1.7, duration: 0.2 },    // B4
            ];

            // ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ï¼ˆä½éŸ³ã§ãƒ‰ã‚­ãƒ‰ã‚­æ„Ÿï¼‰
            const bassline = [
                { freq: 164.81, start: 0, duration: 0.3 },      // E3
                { freq: 146.83, start: 0.4, duration: 0.3 },    // D3
                { freq: 164.81, start: 0.8, duration: 0.3 },    // E3
                { freq: 146.83, start: 1.2, duration: 0.3 },    // D3
                { freq: 164.81, start: 1.6, duration: 0.3 },    // E3
            ];

            const now = audioContext.currentTime;
            
            // ãƒ¡ãƒ­ãƒ‡ã‚£å†ç”Ÿ
            melody.forEach(note => {
                const osc = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                osc.type = 'triangle'; // ã‚ˆã‚Šç·Šå¼µæ„Ÿã®ã‚ã‚‹éŸ³è‰²
                osc.frequency.value = note.freq;
                
                gainNode.gain.setValueAtTime(0, now + note.start);
                gainNode.gain.linearRampToValueAtTime(0.25, now + note.start + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + note.start + note.duration);
                
                osc.connect(gainNode);
                gainNode.connect(bgmGainNode);
                
                osc.start(now + note.start);
                osc.stop(now + note.start + note.duration);
                
                bgmOscillators.push(osc);
            });

            // ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³å†ç”Ÿï¼ˆãƒ‰ã‚­ãƒ‰ã‚­æ„Ÿï¼‰
            bassline.forEach(note => {
                const osc = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                osc.type = 'sawtooth'; // é‡åšãªä½éŸ³
                osc.frequency.value = note.freq;
                
                gainNode.gain.setValueAtTime(0, now + note.start);
                gainNode.gain.linearRampToValueAtTime(0.15, now + note.start + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + note.start + note.duration);
                
                osc.connect(gainNode);
                gainNode.connect(bgmGainNode);
                
                osc.start(now + note.start);
                osc.stop(now + note.start + note.duration);
                
                bgmOscillators.push(osc);
            });

            // ãƒ«ãƒ¼ãƒ—å†ç”Ÿï¼ˆé€Ÿã‚ã®ãƒ†ãƒ³ãƒã§ç·Šè¿«æ„Ÿï¼‰
            bgmTimeout = setTimeout(() => {
                if (bgmOscillators.length > 0) {
                    playBGM();
                }
            }, 1900); // ã‚ˆã‚Šé€Ÿã„ãƒ«ãƒ¼ãƒ—
        }

        // BGMåœæ­¢
        function stopBGM() {
            // ã‚¿ã‚¤ãƒãƒ¼ã‚’ã‚¯ãƒªã‚¢
            if (bgmTimeout) {
                clearTimeout(bgmTimeout);
                bgmTimeout = null;
            }
            
            // ã‚ªã‚·ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’åœæ­¢
            bgmOscillators.forEach(osc => {
                try {
                    osc.stop();
                } catch(e) {}
            });
            bgmOscillators = [];
        }

        // ç„¦ç‡¥æ„Ÿã®ã‚ã‚‹åŠ¹æœéŸ³ï¼ˆ10ç§’åˆ‡ã£ãŸæ™‚ï¼‰
        function playUrgentSound() {
            if (!audioContext || isMuted) return;
            
            const now = audioContext.currentTime;
            
            // ä¸å®‰ãªå’ŒéŸ³
            [440, 554.37, 659.25].forEach((freq, i) => {
                const osc = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                osc.type = 'triangle';
                osc.frequency.value = freq;
                
                gainNode.gain.setValueAtTime(0, now);
                gainNode.gain.linearRampToValueAtTime(0.15, now + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.5);
                
                osc.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                osc.start(now);
                osc.stop(now + 0.5);
            });
        }

        // æ­£è§£éŸ³
        function playCorrectSound() {
            if (!audioContext || isMuted) return;
            
            const now = audioContext.currentTime;
            [523.25, 659.25, 783.99].forEach((freq, i) => {
                const osc = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                osc.type = 'sine';
                osc.frequency.value = freq;
                
                gainNode.gain.setValueAtTime(0, now + i * 0.1);
                gainNode.gain.linearRampToValueAtTime(0.2, now + i * 0.1 + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + i * 0.1 + 0.3);
                
                osc.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                osc.start(now + i * 0.1);
                osc.stop(now + i * 0.1 + 0.3);
            });
        }

        // ä¸æ­£è§£éŸ³
        function playIncorrectSound() {
            if (!audioContext || isMuted) return;
            
            const now = audioContext.currentTime;
            const osc = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(200, now);
            osc.frequency.exponentialRampToValueAtTime(100, now + 0.3);
            
            gainNode.gain.setValueAtTime(0.2, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
            
            osc.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            osc.start(now);
            osc.stop(now + 0.3);
        }

        // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³éŸ³ï¼ˆæ®‹ã‚Š5ç§’ä»¥ä¸‹ï¼‰
        function playTickSound() {
            if (!audioContext || isMuted) return;
            
            const now = audioContext.currentTime;
            const osc = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            osc.type = 'square';
            osc.frequency.value = 880;
            
            gainNode.gain.setValueAtTime(0.1, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
            
            osc.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            osc.start(now);
            osc.stop(now + 0.1);
        }

        // æ™‚é–“åˆ‡ã‚ŒéŸ³ï¼ˆã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ï¼‰
        function playTimeUpSound() {
            if (!audioContext || isMuted) return;
            
            const now = audioContext.currentTime;
            
            // ä¸‹é™ã™ã‚‹ã‚µã‚¤ãƒ¬ãƒ³éŸ³
            const osc1 = audioContext.createOscillator();
            const gainNode1 = audioContext.createGain();
            
            osc1.type = 'sawtooth';
            osc1.frequency.setValueAtTime(440, now);
            osc1.frequency.exponentialRampToValueAtTime(220, now + 0.5);
            osc1.frequency.exponentialRampToValueAtTime(110, now + 1.0);
            
            gainNode1.gain.setValueAtTime(0.3, now);
            gainNode1.gain.exponentialRampToValueAtTime(0.01, now + 1.0);
            
            osc1.connect(gainNode1);
            gainNode1.connect(audioContext.destination);
            
            osc1.start(now);
            osc1.stop(now + 1.0);
            
            // é‡ã­ã‚‹ä½éŸ³
            const osc2 = audioContext.createOscillator();
            const gainNode2 = audioContext.createGain();
            
            osc2.type = 'triangle';
            osc2.frequency.setValueAtTime(110, now);
            osc2.frequency.exponentialRampToValueAtTime(55, now + 1.0);
            
            gainNode2.gain.setValueAtTime(0.2, now);
            gainNode2.gain.exponentialRampToValueAtTime(0.01, now + 1.0);
            
            osc2.connect(gainNode2);
            gainNode2.connect(audioContext.destination);
            
            osc2.start(now);
            osc2.stop(now + 1.0);
        }

        // ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—é€šçŸ¥ã‚’è¡¨ç¤º
        function showLevelUp(levelName) {
            const notification = document.getElementById('level-up-notification');
            const text = document.querySelector('.level-up-text');
            
            text.textContent = `ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ï¼\n${levelName}`;
            notification.classList.add('show');
            
            // ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’è¿½åŠ 
            createParticles(notification);
            
            // åŠ¹æœéŸ³
            playLevelUpSound();
            
            // 2ç§’å¾Œã«éè¡¨ç¤º
            setTimeout(() => {
                notification.classList.remove('show');
                // ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã‚’ã‚¯ãƒªã‚¢
                const particlesContainer = notification.querySelector('.particles');
                if (particlesContainer) {
                    particlesContainer.remove();
                }
            }, 2000);
        }

        // ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆ
        function createParticles(container) {
            const particlesContainer = document.createElement('div');
            particlesContainer.className = 'particles';
            
            // 20å€‹ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã‚’ç”Ÿæˆ
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.setProperty('--x-offset', (Math.random() - 0.5) * 200 + 'px');
                particle.style.animationDelay = Math.random() * 2 + 's';
                particle.style.animationDuration = (2 + Math.random() * 2) + 's';
                particlesContainer.appendChild(particle);
            }
            
            container.appendChild(particlesContainer);
        }

        // ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—éŸ³
        function playLevelUpSound() {
            if (!audioContext || isMuted) return;
            
            const now = audioContext.currentTime;
            
            // ä¸Šæ˜‡éŸ³éš
            [523.25, 659.25, 783.99, 1046.50].forEach((freq, i) => {
                const osc = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                osc.type = 'sine';
                osc.frequency.value = freq;
                
                gainNode.gain.setValueAtTime(0, now + i * 0.1);
                gainNode.gain.linearRampToValueAtTime(0.2, now + i * 0.1 + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + i * 0.1 + 0.2);
                
                osc.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                osc.start(now + i * 0.1);
                osc.stop(now + i * 0.1 + 0.2);
            });
        }
        function toggleMute() {
            isMuted = !isMuted;
            const muteBtn = document.getElementById('mute-btn-game');
            
            if (muteBtn) {
                if (isMuted) {
                    muteBtn.textContent = 'ğŸ”‡';
                    stopBGM();
                    if (audioContext) {
                        audioContext.suspend();
                    }
                } else {
                    muteBtn.textContent = 'ğŸ”Š';
                    if (audioContext) {
                        audioContext.resume();
                    }
                    if (document.getElementById('game-area').classList.contains('hidden') === false) {
                        playBGM();
                    }
                }
            }
        }

        // ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹ï¼ˆç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ä»˜ãï¼‰
        function goBackHome() {
            if (confirm('ã‚²ãƒ¼ãƒ ã‚’ä¸­æ–­ã—ã¦ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚Šã¾ã™ã‹ï¼Ÿ\nç¾åœ¨ã®ã‚¹ã‚³ã‚¢ã¯ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚')) {
                if (timer) clearInterval(timer);
                stopBGM();
                
                document.getElementById('game-area').classList.add('hidden');
                document.getElementById('game-over').classList.remove('show');
                document.getElementById('start-screen').classList.remove('hidden');
                
                playMenuBGM();
            }
        }

        // æ–‡å­—ãƒœãƒƒã‚¯ã‚¹ã‚’ç”Ÿæˆ
        function createLetterBoxes(length) {
            const container = document.getElementById('letter-boxes');
            container.innerHTML = '';
            currentAnswer = '';
            currentCursorPos = 0;
            
            const firstLetter = gameQuestions[currentQuestionIndex].answer[0].toLowerCase();
            
            for (let i = 0; i < length; i++) {
                const box = document.createElement('div');
                box.className = 'letter-box';
                box.id = `letter-box-${i}`;
                
                // ä¸€æ–‡å­—ç›®ã¯ãƒ’ãƒ³ãƒˆã¨ã—ã¦è¡¨ç¤º
                if (i === 0) {
                    box.textContent = firstLetter;
                    box.classList.add('filled', 'hint-letter');
                }
                
                container.appendChild(box);
            }
            
            // äºŒæ–‡å­—ç›®ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ï¼ˆä¸€æ–‡å­—ç›®ã¯å›ºå®šï¼‰
            if (length > 1) {
                document.getElementById('letter-box-1').classList.add('active');
            }
        }

        // æ–‡å­—ãƒœãƒƒã‚¯ã‚¹ã‚’æ›´æ–°
        function updateLetterBoxes() {
            const answerLength = gameQuestions[currentQuestionIndex].answer.length;
            const firstLetter = gameQuestions[currentQuestionIndex].answer[0].toLowerCase();
            
            // ä¸€æ–‡å­—ç›®ã¯ãƒ’ãƒ³ãƒˆãªã®ã§ã‚¹ã‚­ãƒƒãƒ—ã€2æ–‡å­—ç›®ä»¥é™ã‚’å‡¦ç†
            for (let i = 1; i < answerLength; i++) {
                const box = document.getElementById(`letter-box-${i}`);
                const answerIndex = i - 1; // currentAnswerã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆä¸€æ–‡å­—ç›®ãŒãªã„ã®ã§-1ï¼‰
                
                if (answerIndex < currentAnswer.length) {
                    box.textContent = currentAnswer[answerIndex];
                    box.classList.add('filled');
                    box.classList.remove('active');
                } else {
                    box.textContent = '';
                    box.classList.remove('filled');
                    box.classList.remove('active');
                }
            }
            
            // ç¾åœ¨ã®ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ï¼ˆä¸€æ–‡å­—ç›®ã®æ¬¡ã‹ã‚‰ï¼‰
            if (currentAnswer.length < answerLength - 1) {
                document.getElementById(`letter-box-${currentAnswer.length + 1}`).classList.add('active');
            }
        }

        // ã‚­ãƒ¼å…¥åŠ›å‡¦ç†ï¼ˆPCç”¨ã®ã¿ï¼‰
        function handleKeyInput(e) {
            // inputãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‹ã‚‰ã®å…¥åŠ›ã®å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—
            if (e.target.id === 'answer-input') {
                return;
            }

            const answerLength = gameQuestions[currentQuestionIndex].answer.length;
            const requiredInputLength = answerLength - 1; // ä¸€æ–‡å­—ç›®ã¯ãƒ’ãƒ³ãƒˆãªã®ã§-1
            
            if (e.key === 'Backspace') {
                e.preventDefault();
                if (currentAnswer.length > 0) {
                    currentAnswer = currentAnswer.slice(0, -1);
                    updateLetterBoxes();
                    updateInputField();
                }
            } else if (e.key === 'Enter') {
                if (currentAnswer.length === requiredInputLength && !document.getElementById('submit-btn').disabled) {
                    checkAnswer();
                }
            } else if (e.key.length === 1 && /[a-zA-Z]/.test(e.key)) {
                e.preventDefault();
                if (currentAnswer.length < requiredInputLength) {
                    currentAnswer += e.key.toLowerCase();
                    updateLetterBoxes();
                    updateInputField();
                    
                    // å…¨éƒ¨å…¥åŠ›ã—ãŸã‚‰è‡ªå‹•çš„ã«å›ç­”
                    if (currentAnswer.length === requiredInputLength) {
                        setTimeout(() => {
                            if (!document.getElementById('submit-btn').disabled) {
                                checkAnswer();
                            }
                        }, 300);
                    }
                }
            }
        }

        // ãƒ¢ãƒã‚¤ãƒ«å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ›´æ–°
        function updateInputField() {
            const inputField = document.getElementById('answer-input');
            inputField.value = currentAnswer;
        }

        // ãƒ¢ãƒã‚¤ãƒ«å…¥åŠ›ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
        function handleMobileInput(e) {
            const answerLength = gameQuestions[currentQuestionIndex].answer.length;
            const requiredInputLength = answerLength - 1;
            
            // ç¾åœ¨ã®å…¥åŠ›å€¤ã‹ã‚‰è‹±å­—ã®ã¿æŠ½å‡º
            const inputValue = e.target.value.toLowerCase().replace(/[^a-z]/g, '');
            
            // å…¥åŠ›å€¤ãŒå¤‰ã‚ã£ãŸå ´åˆã®ã¿æ›´æ–°
            if (inputValue !== currentAnswer) {
                // å…¥åŠ›ã‚’åˆ¶é™
                if (inputValue.length <= requiredInputLength) {
                    currentAnswer = inputValue;
                    updateLetterBoxes();
                    
                    // å…¨éƒ¨å…¥åŠ›ã—ãŸã‚‰è‡ªå‹•çš„ã«å›ç­”
                    if (currentAnswer.length === requiredInputLength) {
                        setTimeout(() => {
                            if (!document.getElementById('submit-btn').disabled) {
                                checkAnswer();
                            }
                        }, 300);
                    }
                }
                
                // inputãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ã‚’ç¾åœ¨ã®ç­”ãˆã«åŒæœŸ
                e.target.value = currentAnswer;
            }
        }

        // æ–‡å­—ãƒœãƒƒã‚¯ã‚¹ã‚¯ãƒªãƒƒã‚¯ã§å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
        function focusInput() {
            const inputField = document.getElementById('answer-input');
            inputField.focus();
        }

        // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function getRank(score, total) {
            const percentage = (score / total) * 100;
            if (percentage === 100) return 'ğŸ‘‘ ä¼èª¬ã®å‹‡è€…ï¼';
            if (percentage >= 80) return 'âš”ï¸ ç‹å›½ã®å®ˆè­·è€…ï¼';
            if (percentage >= 60) return 'ğŸ›¡ï¸ ç†Ÿç·´ã®æˆ¦å£«ï¼';
            if (percentage >= 40) return 'ğŸ—¡ï¸ è¦‹ç¿’ã„å†’é™ºè€…ï¼';
            return 'ğŸ’ª ä¿®è¡Œä¸­ï¼';
        }

        // é€²æ—ãƒ‰ãƒƒãƒˆã‚’åˆæœŸåŒ–
        function initProgressDots() {
            const container = document.getElementById('progress-dots');
            container.innerHTML = '';
            
            for (let i = 0; i < 10; i++) {
                const dot = document.createElement('div');
                dot.className = 'progress-dot';
                dot.id = `dot-${i}`;
                container.appendChild(dot);
            }
        }

        // é€²æ—ãƒ‰ãƒƒãƒˆã‚’æ›´æ–°
        function updateProgressDots() {
            // å…¨ã¦ã®ãƒ‰ãƒƒãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ
            for (let i = 0; i < 10; i++) {
                const dot = document.getElementById(`dot-${i}`);
                dot.className = 'progress-dot';
            }
            
            // å›ç­”æ¸ˆã¿ã®å•é¡Œã«ãƒãƒ¼ã‚¯ã‚’ä»˜ã‘ã‚‹
            answeredQuestions.forEach((q, index) => {
                const dot = document.getElementById(`dot-${index}`);
                if (q.isCorrect) {
                    dot.classList.add('correct');
                } else {
                    dot.classList.add('incorrect');
                }
            });
            
            // ç¾åœ¨ã®å•é¡Œã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
            if (currentQuestionIndex < 10) {
                const currentDot = document.getElementById(`dot-${currentQuestionIndex}`);
                currentDot.classList.add('current');
            }
        }

        // ã‚²ãƒ¼ãƒ é–‹å§‹
        function startGame(difficulty) {
            currentDifficulty = difficulty;
            currentQuestionIndex = 0;
            correctCount = 0;
            answeredQuestions = [];
            skipsRemaining = 1;

            // ãƒ¡ãƒ‹ãƒ¥ãƒ¼BGMã‚’åœæ­¢ã—ã¦ã‚²ãƒ¼ãƒ BGMã‚’é–‹å§‹
            stopBGM();
            initAudio();
            
            // ãƒ¢ãƒã‚¤ãƒ«ãƒ–ãƒ©ã‚¦ã‚¶å¯¾å¿œ: AudioContextã‚’ç¢ºå®Ÿã«å†é–‹
            if (audioContext && audioContext.state === 'suspended') {
                audioContext.resume().then(() => {
                    playBGM();
                });
            } else {
                playBGM();
            }

            // é›£æ˜“åº¦ã«å¿œã˜ãŸè¨­å®šï¼ˆå…¨ã¦20ç§’ã«çµ±ä¸€ï¼‰
            timeLimit = 20;

            // æ®µéšçš„ãªå•é¡Œé¸æŠï¼ˆ4å• + 3å• + 3å• = 10å•ï¼‰
            gameQuestions = [];
            
            if (difficulty === 'easy') {
                // è‹±æ¤œ5ç´š(4å•) â†’ 4ç´š(3å•) â†’ 3ç´š(3å•)
                const level1 = shuffleArray(questionBank.easy.grade5).slice(0, 4);
                const level2 = shuffleArray(questionBank.easy.grade4).slice(0, 3);
                const level3 = shuffleArray(questionBank.easy.grade3).slice(0, 3);
                gameQuestions = [...level1, ...level2, ...level3];
            } else if (difficulty === 'normal') {
                // æº–2ç´š(4å•) â†’ 2ç´šå‰åŠ(3å•) â†’ 2ç´šå¾ŒåŠ(3å•)
                const level1 = shuffleArray(questionBank.normal.preGrade2).slice(0, 4);
                const level2 = shuffleArray(questionBank.normal.grade2Early).slice(0, 3);
                const level3 = shuffleArray(questionBank.normal.grade2Late).slice(0, 3);
                gameQuestions = [...level1, ...level2, ...level3];
            } else if (difficulty === 'hard') {
                // æº–1ç´š(4å•) â†’ 1ç´šå‰åŠ(3å•) â†’ 1ç´šå¾ŒåŠ(3å•)
                const level1 = shuffleArray(questionBank.hard.preGrade1).slice(0, 4);
                const level2 = shuffleArray(questionBank.hard.grade1Early).slice(0, 3);
                const level3 = shuffleArray(questionBank.hard.grade1Late).slice(0, 3);
                gameQuestions = [...level1, ...level2, ...level3];
            }

            // ç”»é¢åˆ‡ã‚Šæ›¿ãˆ
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('game-area').classList.remove('hidden');
            document.getElementById('game-over').classList.remove('show');

            // é€²æ—ãƒ‰ãƒƒãƒˆã‚’åˆæœŸåŒ–
            initProgressDots();
            updateProgressDots();

            loadQuestion();
        }

        // ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹
        function startTimer() {
            if (timer) clearInterval(timer);
            
            timeLeft = timeLimit;
            document.getElementById('timer').textContent = timeLeft;
            document.getElementById('timer').classList.remove('warning');
            document.getElementById('timer').style.display = 'none'; // åˆæœŸã¯éè¡¨ç¤º
            document.getElementById('meaning').classList.remove('urgent');

            timer = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = timeLeft;

                // 10ç§’ä»¥ä¸‹ã«ãªã£ãŸã‚‰ã‚¿ã‚¤ãƒãƒ¼ã‚’è¡¨ç¤º
                if (timeLeft <= 10) {
                    document.getElementById('timer').style.display = 'block';
                }

                if (timeLeft === 10) {
                    document.getElementById('meaning').classList.add('urgent');
                    playUrgentSound();
                }

                if (timeLeft <= 5 && timeLeft > 0) {
                    document.getElementById('timer').classList.add('warning');
                    playTickSound();
                }

                if (timeLeft <= 0) {
                    clearInterval(timer);
                    timeUp();
                }
            }, 1000);
        }

        // æ™‚é–“åˆ‡ã‚Œ
        function timeUp() {
            const resultDiv = document.getElementById('result');
            const correctAnswer = gameQuestions[currentQuestionIndex].answer;
            
            resultDiv.className = 'result incorrect';
            resultDiv.innerHTML = `â° æ™‚é–“åˆ‡ã‚Œï¼<br><span class="correct-answer">æ­£è§£: ${correctAnswer}</span>`;
            resultDiv.style.display = 'block';
            
            document.getElementById('answer-input').disabled = true;
            document.getElementById('submit-btn').disabled = true;
            document.getElementById('skip-btn').disabled = true;

            playTimeUpSound();

            answeredQuestions.push({
                question: gameQuestions[currentQuestionIndex].meaning,
                userAnswer: '',
                correctAnswer: correctAnswer,
                isCorrect: false,
                isTimeout: true
            });

            // 2ç§’å¾Œã«ã‚²ãƒ¼ãƒ çµ‚äº†
            setTimeout(() => {
                endGame();
            }, 2000);
        }

        // å•é¡Œèª­ã¿è¾¼ã¿
        function loadQuestion() {
            const question = gameQuestions[currentQuestionIndex];
            document.getElementById('current-question').textContent = currentQuestionIndex + 1;
            document.getElementById('meaning').textContent = question.meaning;
            document.getElementById('meaning').classList.remove('urgent');
            document.getElementById('hint').textContent = `ãƒ’ãƒ³ãƒˆ: ${question.hint}`;
            
            // é€²æ—ãƒ‰ãƒƒãƒˆã‚’æ›´æ–°
            updateProgressDots();
            
            // ãƒ¬ãƒ™ãƒ«åã‚’åˆ¤å®šï¼ˆãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—é€šçŸ¥ç”¨ã®ã¿ï¼‰
            let levelName = '';
            
            if (currentDifficulty === 'easy') {
                if (currentQuestionIndex >= 7) {
                    levelName = 'è‹±æ¤œ3ç´šãƒ¬ãƒ™ãƒ«';
                } else if (currentQuestionIndex >= 4) {
                    levelName = 'è‹±æ¤œ4ç´šãƒ¬ãƒ™ãƒ«';
                } else {
                    levelName = 'è‹±æ¤œ5ç´šãƒ¬ãƒ™ãƒ«';
                }
            } else if (currentDifficulty === 'normal') {
                if (currentQuestionIndex >= 7) {
                    levelName = 'è‹±æ¤œ2ç´šå¾ŒåŠãƒ¬ãƒ™ãƒ«';
                } else if (currentQuestionIndex >= 4) {
                    levelName = 'è‹±æ¤œ2ç´šå‰åŠãƒ¬ãƒ™ãƒ«';
                } else {
                    levelName = 'è‹±æ¤œæº–2ç´šãƒ¬ãƒ™ãƒ«';
                }
            } else if (currentDifficulty === 'hard') {
                if (currentQuestionIndex >= 7) {
                    levelName = 'è‹±æ¤œ1ç´šå¾ŒåŠãƒ¬ãƒ™ãƒ«';
                } else if (currentQuestionIndex >= 4) {
                    levelName = 'è‹±æ¤œ1ç´šå‰åŠãƒ¬ãƒ™ãƒ«';
                } else {
                    levelName = 'è‹±æ¤œæº–1ç´šãƒ¬ãƒ™ãƒ«';
                }
            }
            
            // ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—é€šçŸ¥ï¼ˆ5å•ç›®ã¨8å•ç›®ï¼‰
            if (currentQuestionIndex === 4 || currentQuestionIndex === 7) {
                showLevelUp(levelName);
                // é€šçŸ¥ãŒæ¶ˆãˆã‚‹ã¾ã§å¾…ã£ã¦ã‹ã‚‰å•é¡Œé–‹å§‹
                setTimeout(() => {
                    continueLoadQuestion();
                }, 2200);
            } else {
                continueLoadQuestion();
            }
        }

        // å•é¡Œèª­ã¿è¾¼ã¿ã‚’ç¶šè¡Œ
        function continueLoadQuestion() {
            // æ–‡å­—ãƒœãƒƒã‚¯ã‚¹ã‚’ç”Ÿæˆ
            const question = gameQuestions[currentQuestionIndex];
            createLetterBoxes(question.answer.length);
            
            const inputField = document.getElementById('answer-input');
            inputField.value = '';
            inputField.disabled = false;
            inputField.focus();
            
            document.getElementById('submit-btn').disabled = false;
            document.getElementById('result').style.display = 'none';
            document.getElementById('result').className = 'result';

            // ã‚¹ã‚­ãƒƒãƒ—ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’æ›´æ–°
            const skipBtn = document.getElementById('skip-btn');
            const skipCount = document.getElementById('skip-count');
            if (skipsRemaining > 0) {
                skipBtn.disabled = false;
                skipCount.textContent = `(æ®‹ã‚Š${skipsRemaining}å›)`;
            } else {
                skipBtn.disabled = true;
                skipCount.textContent = '(ä½¿ç”¨æ¸ˆã¿)';
            }

            startTimer();
        }

        // å›ç­”ãƒã‚§ãƒƒã‚¯
        function checkAnswer() {
            const firstLetter = gameQuestions[currentQuestionIndex].answer[0].toLowerCase();
            const userAnswer = (firstLetter + currentAnswer).trim().toLowerCase();
            const correctAnswer = gameQuestions[currentQuestionIndex].answer.toLowerCase();
            const resultDiv = document.getElementById('result');
            const answerLength = correctAnswer.length;

            if (userAnswer === correctAnswer) {
                correctCount++;
                
                // ã‚¿ã‚¤ãƒãƒ¼ã‚’åœæ­¢
                if (timer) clearInterval(timer);
                
                resultDiv.className = 'result correct';
                resultDiv.textContent = `ğŸ‰ æ­£è§£ï¼`;
                
                // å…¨ã¦ã®æ–‡å­—ãƒœãƒƒã‚¯ã‚¹ã‚’æ­£è§£è¡¨ç¤º
                for (let i = 0; i < answerLength; i++) {
                    document.getElementById(`letter-box-${i}`).classList.add('correct');
                }
                
                playCorrectSound();

                document.getElementById('answer-input').disabled = true;
                document.getElementById('submit-btn').disabled = true;

                answeredQuestions.push({
                    question: gameQuestions[currentQuestionIndex].meaning,
                    userAnswer: userAnswer,
                    correctAnswer: correctAnswer,
                    isCorrect: true
                });

                setTimeout(() => {
                    nextQuestion();
                }, 2000);
            } else {
                // ä¸æ­£è§£ã®å ´åˆã¯å…¥åŠ›ã‚’ã‚¯ãƒªã‚¢ã—ã¦å†æŒ‘æˆ¦å¯èƒ½ï¼ˆã‚¿ã‚¤ãƒãƒ¼ã¯ç¶™ç¶šï¼‰
                resultDiv.className = 'result incorrect';
                resultDiv.innerHTML = `âŒ ä¸æ­£è§£ï¼ã‚‚ã†ä¸€åº¦å…¥åŠ›ã—ã¦ãã ã•ã„`;
                
                // æ–‡å­—ãƒœãƒƒã‚¯ã‚¹ã‚’ä¸€æ™‚çš„ã«èµ¤ãè¡¨ç¤ºï¼ˆä¸€æ–‡å­—ç›®ã¯ã‚¹ã‚­ãƒƒãƒ—ï¼‰
                for (let i = 1; i < answerLength; i++) {
                    const box = document.getElementById(`letter-box-${i}`);
                    box.classList.add('incorrect');
                }
                
                playIncorrectSound();

                // 1ç§’å¾Œã«å…¥åŠ›ã‚’ã‚¯ãƒªã‚¢ã—ã¦å†æŒ‘æˆ¦
                setTimeout(() => {
                    currentAnswer = '';
                    updateLetterBoxes();
                    updateInputField();
                    
                    // incorrect ã‚¯ãƒ©ã‚¹ã‚’å‰Šé™¤ï¼ˆä¸€æ–‡å­—ç›®ã¯ã‚¹ã‚­ãƒƒãƒ—ï¼‰
                    for (let i = 1; i < answerLength; i++) {
                        document.getElementById(`letter-box-${i}`).classList.remove('incorrect');
                    }
                    
                    resultDiv.style.display = 'none';
                    
                    // å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
                    document.getElementById('answer-input').focus();
                    
                    // ã‚¿ã‚¤ãƒãƒ¼ã¯ç¶™ç¶šï¼ˆå†é–‹ã—ãªã„ï¼‰
                }, 1000);
            }
        }

        // ã‚¹ã‚­ãƒƒãƒ—
        function skipQuestion() {
            if (skipsRemaining <= 0) {
                return;
            }

            if (timer) clearInterval(timer);

            skipsRemaining--;

            const resultDiv = document.getElementById('result');
            const correctAnswer = gameQuestions[currentQuestionIndex].answer;

            resultDiv.className = 'result';
            resultDiv.innerHTML = `â­ï¸ å•é¡Œã‚’å¤‰æ›´ã—ã¾ã™...`;
            resultDiv.style.display = 'block';

            // 1ç§’å¾Œã«æ–°ã—ã„å•é¡Œã‚’è¡¨ç¤º
            setTimeout(() => {
                resultDiv.style.display = 'none';
                
                // ç¾åœ¨ã®ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ãŸæ–°ã—ã„å•é¡Œã‚’é¸æŠ
                let newQuestion;
                const currentLevel = currentQuestionIndex;
                
                if (currentDifficulty === 'easy') {
                    if (currentLevel < 4) {
                        const pool = questionBank.easy.grade5.filter(q => q.answer !== correctAnswer);
                        newQuestion = pool[Math.floor(Math.random() * pool.length)];
                    } else if (currentLevel < 7) {
                        const pool = questionBank.easy.grade4.filter(q => q.answer !== correctAnswer);
                        newQuestion = pool[Math.floor(Math.random() * pool.length)];
                    } else {
                        const pool = questionBank.easy.grade3.filter(q => q.answer !== correctAnswer);
                        newQuestion = pool[Math.floor(Math.random() * pool.length)];
                    }
                } else if (currentDifficulty === 'normal') {
                    if (currentLevel < 4) {
                        const pool = questionBank.normal.preGrade2.filter(q => q.answer !== correctAnswer);
                        newQuestion = pool[Math.floor(Math.random() * pool.length)];
                    } else if (currentLevel < 7) {
                        const pool = questionBank.normal.grade2Early.filter(q => q.answer !== correctAnswer);
                        newQuestion = pool[Math.floor(Math.random() * pool.length)];
                    } else {
                        const pool = questionBank.normal.grade2Late.filter(q => q.answer !== correctAnswer);
                        newQuestion = pool[Math.floor(Math.random() * pool.length)];
                    }
                } else if (currentDifficulty === 'hard') {
                    if (currentLevel < 4) {
                        const pool = questionBank.hard.preGrade1.filter(q => q.answer !== correctAnswer);
                        newQuestion = pool[Math.floor(Math.random() * pool.length)];
                    } else if (currentLevel < 7) {
                        const pool = questionBank.hard.grade1Early.filter(q => q.answer !== correctAnswer);
                        newQuestion = pool[Math.floor(Math.random() * pool.length)];
                    } else {
                        const pool = questionBank.hard.grade1Late.filter(q => q.answer !== correctAnswer);
                        newQuestion = pool[Math.floor(Math.random() * pool.length)];
                    }
                }
                
                // æ–°ã—ã„å•é¡Œã«å·®ã—æ›¿ãˆ
                if (newQuestion) {
                    gameQuestions[currentQuestionIndex] = newQuestion;
                    
                    // å•é¡Œè¡¨ç¤ºã‚’æ›´æ–°
                    document.getElementById('meaning').textContent = newQuestion.meaning;
                    document.getElementById('hint').textContent = `ãƒ’ãƒ³ãƒˆ: ${newQuestion.hint}`;
                    
                    // å…¥åŠ›ã‚’ãƒªã‚»ãƒƒãƒˆ
                    currentAnswer = '';
                    
                    // æ–‡å­—ãƒœãƒƒã‚¯ã‚¹ã‚’å†ç”Ÿæˆï¼ˆæ­£ã—ã„é•·ã•ã§ï¼‰
                    const answerLength = newQuestion.answer.length;
                    createLetterBoxes(answerLength);
                    updateInputField();
                    
                    // ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
                    document.getElementById('answer-input').disabled = false;
                    document.getElementById('submit-btn').disabled = false;
                    document.getElementById('skip-btn').disabled = false;
                    
                    // å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
                    document.getElementById('answer-input').focus();
                    
                    // ã‚¿ã‚¤ãƒãƒ¼ã‚’å†ã‚¹ã‚¿ãƒ¼ãƒˆ
                    startTimer();
                }
            }, 1000);
        }

        // æ¬¡ã®å•é¡Œã¸
        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < 10) {
                loadQuestion();
            } else {
                endGame();
            }
        }

        // ã‚²ãƒ¼ãƒ çµ‚äº†
        function endGame() {
            if (timer) clearInterval(timer);
            stopBGM();

            document.getElementById('game-area').classList.add('hidden');
            document.getElementById('game-over').classList.add('show');
            
            // å®Ÿéš›ã«è§£ç­”ã—ãŸå•é¡Œæ•°
            const totalQuestions = answeredQuestions.length;
            
            // æ­£è§£æ•°ã®ã¿è¡¨ç¤º
            document.getElementById('final-score').textContent = `${correctCount} å•æ­£è§£`;
            document.getElementById('rank-display').textContent = getRank(correctCount, totalQuestions);
            
            const difficultyNames = {
                easy: 'è‹±æ¤œ3ç´š',
                normal: 'è‹±æ¤œ2ç´š',
                hard: 'è‹±æ¤œ1ç´š'
            };
            document.getElementById('difficulty-display').textContent = difficultyNames[currentDifficulty];

            // æ­£è§£ãƒ»ä¸æ­£è§£ã®å˜èªãƒªã‚¹ãƒˆã‚’ä½œæˆ
            const correctWordsList = document.getElementById('correct-words-list');
            const incorrectWordsList = document.getElementById('incorrect-words-list');
            
            correctWordsList.innerHTML = '';
            incorrectWordsList.innerHTML = '';

            const correctWords = [];
            const incorrectWords = [];

            answeredQuestions.forEach(q => {
                if (q.isCorrect) {
                    correctWords.push(q);
                } else {
                    incorrectWords.push(q);
                }
            });

            // æ­£è§£ã—ãŸå˜èªã‚’è¡¨ç¤º
            if (correctWords.length > 0) {
                correctWords.forEach(word => {
                    const item = document.createElement('div');
                    item.className = 'word-item correct';
                    item.innerHTML = `
                        <div class="word-meaning">${word.question}</div>
                        <div class="word-english">${word.correctAnswer}</div>
                    `;
                    correctWordsList.appendChild(item);
                });
            } else {
                correctWordsList.innerHTML = '<div class="no-words">æ­£è§£ã—ãŸå˜èªã¯ã‚ã‚Šã¾ã›ã‚“</div>';
            }

            // é–“é•ãˆãŸå˜èªã‚’è¡¨ç¤º
            if (incorrectWords.length > 0) {
                incorrectWords.forEach(word => {
                    const item = document.createElement('div');
                    item.className = 'word-item incorrect';
                    item.innerHTML = `
                        <div class="word-meaning">${word.question}</div>
                        <div class="word-english">${word.correctAnswer}</div>
                    `;
                    incorrectWordsList.appendChild(item);
                });
            } else {
                incorrectWordsList.innerHTML = '<div class="no-words">é–“é•ãˆãŸå˜èªã¯ã‚ã‚Šã¾ã›ã‚“</div>';
            }
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        document.getElementById('submit-btn').addEventListener('click', checkAnswer);
        document.getElementById('skip-btn').addEventListener('click', skipQuestion);
        
        document.getElementById('restart-btn').addEventListener('click', () => {
            startGame(currentDifficulty);
        });

        document.getElementById('home-btn').addEventListener('click', () => {
            document.getElementById('game-over').classList.remove('show');
            document.getElementById('start-screen').classList.remove('hidden');
            stopBGM();
            playMenuBGM();
        });

        document.getElementById('back-home-game-btn').addEventListener('click', goBackHome);

        // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã‚’å‡¦ç†ï¼ˆPCç”¨ï¼‰
        document.addEventListener('keydown', (e) => {
            // ã‚²ãƒ¼ãƒ ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹æ™‚ã®ã¿å‡¦ç†
            if (!document.getElementById('game-area').classList.contains('hidden')) {
                handleKeyInput(e);
            }
        });

        // ãƒ¢ãƒã‚¤ãƒ«å…¥åŠ›ã‚’å‡¦ç†
        document.getElementById('answer-input').addEventListener('input', handleMobileInput);

        // æ–‡å­—ãƒœãƒƒã‚¯ã‚¹ã‚¯ãƒªãƒƒã‚¯/ã‚¿ãƒƒãƒ—ã§å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
        document.getElementById('letter-boxes').addEventListener('click', focusInput);
        document.getElementById('letter-boxes').addEventListener('touchstart', focusInput);

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒ¡ãƒ‹ãƒ¥ãƒ¼BGMã‚’é–‹å§‹ï¼ˆåˆå›ã‚¯ãƒªãƒƒã‚¯æ™‚ï¼‰
        let menuBGMStarted = false;
        window.addEventListener('load', () => {
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³å¾Œã«éŸ³å£°ã‚’å†ç”Ÿï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒãƒªã‚·ãƒ¼å¯¾å¿œï¼‰
            const startMenuBGM = () => {
                if (!menuBGMStarted && !audioContext && document.getElementById('start-screen').classList.contains('hidden') === false) {
                    menuBGMStarted = true;
                    initAudio(); // AudioContextã‚’åˆæœŸåŒ–
                    playMenuBGM();
                    document.body.removeEventListener('click', startMenuBGM);
                    document.body.removeEventListener('touchstart', startMenuBGM);
                }
            };
            document.body.addEventListener('click', startMenuBGM);
            document.body.addEventListener('touchstart', startMenuBGM); // ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ
        });
    </script>
</body>
</html>
